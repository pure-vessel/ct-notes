\documentclass{article}
\input{header}
\input{formal}
\input{graphs}

\fancyhead[L]{Дискретная математика}

\begin{document}
    \tableofcontents\pagebreak
    \paragraph{Основные определения теории графов.}
    \begin{definition}
        \textbf{(Неориентированным) графом} называется пара из множеств $V$ и $E$, где $E\subset V\times V\setminus\{(u;u)\mid u\in V\}/_{(u;v)\sim(v;u)}$.
    \end{definition}
    \begin{definition}
        \textbf{(Неориентированным) графом с кратными рёбрами} называется набор множеств $V$, $E$ и функции $\mathrm{ends}\colon E\to A\subset 2^X$, где $A=\{B\subset V\mid |B|=2\}$, определяющей концы ребра. При этом 
    \end{definition}
    \begin{definition}
        \textbf{(Неориентированным) графом с кратными рёбрами и петлями} называется то же самое, что и в предыдущем определении, но $1\leqslant|B|\leqslant2$.
    \end{definition}
    \begin{definition}
        \textbf{(Неориентированным) графом с петлями} называется пара из множеств $V$ и $E$, где $E\subset V\times V/_{(u;v)\sim(v;u)}$.
    \end{definition}
    \begin{definition}
        \textbf{Ориентированным графом (с петлями)} называется пара из множеств $V$ и $E\subset V\times V$.
    \end{definition}
    \begin{definition}
        \textbf{Ориентированным графом с кратными рёбрами (и петлями)} называется набор из множеств $V$ и $E$ и двух функций $\mathrm{beg}\colon E\to V$, $\mathrm{end}\colon E\to V$.
    \end{definition}
    \begin{definition}
        Говорят, что ребро и вершина в графе \textbf{инцидентны}, если одним из концов/началом или концом ребра является вершина.
    \end{definition}
    \begin{definition}
        Количество рёбер, с которыми данная вершина инцидентна, называется \textbf{степенью вершины} ($\deg u$). Если разрешены кратные рёбра, считается, что они вносят два в степень, а не один.
    \end{definition}
    \begin{lemma}[Лемма о рукопожатиях.]
        Тривиально,
        $$
        \sum\limits_{u\in V}\deg u=2|E|
        $$
    \end{lemma}
    \begin{definition}
        Количество рёбер, исходящих из данной вершины, называется \textbf{исходящей степенью} ($\deg^-u$ или $\deg_{\mathrm{out}}u$).
    \end{definition}
    \begin{definition}
        Количество рёбер, исходящих из данной вершины, называется \textbf{входящей степенью} ($\deg^+u$ или $\deg_{\mathrm{in}}u$).
    \end{definition}
    \begin{lemma}
        Тривиально,
        $$
        \sum\limits_{u\in V}\deg^+u+\deg^-u=2|E|
        $$
    \end{lemma}
    \paragraph{Связность. Сильная связность. Двусвязность.}
    \begin{definition}
        Последовательность
        $$
        u_0;e_1;u_1;e_2;u_2;\ldots;e_k;u_k
        $$
        где $\forall i\in[0:k]~u_i\in V$, $\forall j\in[1:k]~e_j\in E$ и $\forall i\in[1:k]~u_{i-1}$ и $u_i$ инцидентны $e_i$ называется \textbf{путём} (в неориентированном графе). $k$ называется \textbf{длиной пути}.
    \end{definition}
    \begin{definition}
        Сами допилите напильником предыдущее определение до определения \textbf{пути в ориентированном графе}.
    \end{definition}
    \begin{definition}
        {\large В неориентированном графе}\\
        Циклическим путём называется путь, у которых начало совпадает с концом и длина больше нуля.\\
        Циклические пути называются эквивалентными, если они совпадают с точностью до циклического сдвига.\\
        Классы эквивалентности циклический путей по данной эквивалентности называются \textbf{циклами}.
    \end{definition}
    \begin{definition}
        Путь или цикл в ориентированном графе называется \textbf{рёберно простым}/\textbf{вершинно простым}, если все $e_i$/$v_i$ соотвественно различны.
    \end{definition}
    \begin{definition}
        {\large В ориентированном графе}\\
        Циклическим путём называется путь, у которых начало совпадает с концом и длина больше нуля.\\
        Циклический путь называется корректным, если $\forall i\in[1:k-1]~e_i\neq e_{i+1}$, если $e_i$ не петля и $e_1\neq e_k$, если $e_1$~--- не петля.\\
        Корректные циклические пути называются эквивалентными, если они совпадают с точностью до циклического сдвига и/или отражения.\\
        Классы эквивалентности корректных циклический путей по данной эквивалентности называются \textbf{циклами}.
    \end{definition}
    \begin{definition}
        Путь или цикл в неориентированном графе называется \textbf{рёберно простым}/\textbf{вершинно простым}, если догадайтесь, когда.
    \end{definition}
    \begin{definition}
        Говорят, что $v$ \textbf{достижима} из $u$ ($u\leadsto v$), если существует путь из $u$ в $v$.
    \end{definition}
    \begin{claim}
        Достижимость рефлексивна и транзитивна. В неориентированном графе также симметрична.
    \end{claim}
    \begin{definition}
        Отношение $u\leadsto v\land v\leadsto u$ называется \textbf{отношением сильной связности}.
    \end{definition}
    \begin{claim}
        Отношение сильной связности симметрично.
    \end{claim}
    \begin{definition}
        В неориентированном графе классы эквивалентности по достижимости называются \textbf{компонентами связности}.
    \end{definition}
    \begin{definition}
        В ориентированном графе классы эквивалентности по сильной связности называются \textbf{компонентами сильной связности}.
    \end{definition}
    \begin{definition}
        \textbf{Конденсацией} ориентированного графа называется граф, получаемый из ориентированного графа заменой компонент сильной связности на вершины с сохранением ориентированных рёбер.
    \end{definition}
    \begin{claim}
        Конденсация всегда не содержит циклов.
    \end{claim}
    \begin{definition}
        В неориентированном графе $u,v\in V$ называются рёберно двусвязными, если существуют два пути из $u$ в $v$, не имеющие общих рёбер.
    \end{definition}
    \begin{claim}
        Рёберная двусвязность является отношением эквивалентности.
    \end{claim}
    \begin{proof}
        \begin{itemize}
            \item Рефлексивность: возьмём 2 одинаковых пути из вершины в себя. Они не пересекаются по рёбрам.
            \item Симметричность: очевидно.
            \item Транзитивность. Пусть $u$ двусвязана с $v$, а $v$~--- с $w$. Рассмотрим $p_1$ и $p_2$~--- два пути из $u$ в $v$. Давайте теперь возьмём $w$ и будем из неё идти в сторону $v$ по путям $q_1$ и $q_2$.
            \begin{itemize}
                \item Если мы дошли без пересечения с $p_1$ или $p_2$, мы победили.
                \item Если мы по одному пути пересеклись с $p_1$, а по другому~--- с $p_2$, мы победили.
                \item Если мы пришли на один и тот же путь, то от одного из $q_1$ и $q_2$ пойдём в сторону $u$, а от другого~--- в сторону $v$. В сторону $v$~--- от того, которого ближе. После этого из второго пойдём и $v$ в $u$ по второму пути между ними. Мы победили.
            \end{itemize}
        \end{itemize}
    \end{proof}
    \begin{definition}
        Классы эквивалентности по рёберной двусвязности называются \textbf{компонентами рёберной двусвязности} или \textbf{листами}.
    \end{definition}
    \begin{definition}
        Ребро, концы которого не являются рёберно двусвязными,~--- \textbf{мост}.
    \end{definition}
    \begin{definition}
        Ребро, при удалении которого, количество компонент связности увеличивается,~--- \textbf{мост}.
    \end{definition}
    \begin{theorem}
        Следующие 4 утверждения для связного графа (и первые 3 для несвязного) равносильны.
        \begin{enumerate}
            \item $uv$~--- мост в смысле первого определения.
            \item $uv$~--- мост в смысле второго определения.
            \item $\exists x,y\in V$ любой путь из $x$ в $y$ содержит $uv$.
            \item $V=X\sqcup Y$, $X\neq\varnothing\neq Y$ такие что $\forall x\in X~\forall y\in Y$ любой путь из $x$ в $y$ содержит $uv$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{itemize}
            \item[$1\to2$] Если при удалении количество компонент связности не увеличится, был другой путь $u\leadsto v$. Противоречие.
            \item[$2\to4$] Возьмём в качестве $X$ и $Y$ те две (а тривиально, что в связном графе их две) компоненты связности, на которые развалится наш граф. Всё.
            \item[$4\to3$] Тривиально.
            \item[$3\to1$] Если $u$ и $v$ рёберно двусвязны, то от $x$ до $y$ можно пройти другим путём, игнорируя $uv$.
        \end{itemize}
        Для несвязного графа справьтесь сами.
    \end{proof}
    \begin{example}
        Жирным выделены мосты, цифрами помечены компоненты рёберной двусвязности.
        \begin{figure}[H]
            \begin{tikzpicture}
                \graph[spring electrical layout,node distance=1.5cm,node sep=0mm,nodes={treenode,outer sep=0mm}]{
                    1[as=1] -- 2[as=1] -- 3[as=1] -- 1, 2 -- 4[as=1] -- 3,
                    3 --[very thick] 5[as=2] --[very thick] 6[as=3] --[very thick] 7[as=4],
                    6 -- 8[as=3] -- 9[as=3] -- 6,
                    9 --[very thick] 10[as=5] -- 11[as=5] -- 12[as=5] -- 10, 
                };
            \end{tikzpicture}
        \end{figure}\noindent
    \end{example}
    \begin{definition}
        Два ребра $ab$ и $cd$ называются вершинно двусвязными, если между существуют два вершинно непересекающихся пути $a\leadsto c$ и $b\leadsto d$ (или, наоборот, $a\leadsto d$ и $b\leadsto c$).
    \end{definition}
    \begin{theorem}
        В неориентированном графе без петель вершинная двусвязность является отношением эквивалентности.
    \end{theorem}
    \begin{proof}
        \begin{itemize}
            \item Рефлексивность: очевидно.
            \item Симметричность: очевидно.
            \item Транзитивность: та же заплатка, что и в рёберной двусвязности.
        \end{itemize}
    \end{proof}
    \begin{definition}
        Классы эквивалентности по вершинной двусвязности называются \textbf{компонентами вершинной двусвязности} или \textbf{блоками}.
    \end{definition}
    \begin{definition}
        \textbf{Точкой сочленения} называется вершина, принадлежащая нескольким компонентам вершинной двусвязности.
    \end{definition}
    \begin{definition}
        \textbf{Точкой сочленения} называется вершина, удаление которой (вместе с инцидентными рёбрами) приводит к увеличению компонент связности.
    \end{definition}
    \begin{theorem}
        Сами докажите, что следующие 4 утверждения для связного графа (и первые 3 для несвязного) равносильны.
        \begin{enumerate}
            \item $v$~--- точка сочленения в смысле первого определения.
            \item $v$~--- точка сочленения в смысле второго определения.
            \item $\exists x,y\in V:x\neq v\neq y$ любой путь из $x$ в $y$ содержит $v$.
            \item $V=X\sqcup Y$, $X\neq\varnothing\neq Y$ такие что $\forall x\in X~\forall y\in Y$ любой путь из $x$ в $y$ содержит $v$.
        \end{enumerate}
    \end{theorem}
    \begin{definition}
        \textbf{Дерево блоков~--- точек сочленения}~--- это граф, получаемый из графа заменой блоков на отдельные вершины, добавлением по каждой вершине для точки сочленения и рёбрами, показывающими отношение <<содержать данную точку сочленения>>.
    \end{definition}
    \begin{example}
        \begin{multicols}{2}
            Некоторый граф; обведены компоненты вершинной двусвязности, закрашены вершины, состоящие хотя бы в двух.
            \begin{figure}[H]
                \begin{tikzpicture}
                    \graph[spring layout,node distance=1.5cm,node sep=0mm,nodes={treenode,outer sep=0mm,text width=1.5mm,as=}]{
                        1 -- 2 -- 3 -- 1, 2 -- 4[fill=black] -- 3,
                        4 -- 5,
                        4 -- 6 -- 7[fill=black] -- 4,
                        7 -- 8[fill=black] -- 9[fill=black] -- 10 -- 11 -- 9, 10 -- 12 -- 11,
                        8 -- 13[fill=black] -- 14[fill=black] -- 15 -- 13,
                        14 -- 16[fill=black] -- {17, 18},
                    };
                    \draw[red, opacity=.75] \convexpath{9,10,12,11}{2mm};
                    \draw[darkgreen, opacity=.75] \convexpath{8,9}{2mm};
                    \draw[red, opacity=.75] \convexpath{8,13}{2mm};
                    \draw[darkgreen, opacity=.75] \convexpath{13,14,15}{2mm};
                    \draw[red, opacity=.75] \convexpath{14,16}{2mm};
                    \draw[darkgreen, opacity=.75] \convexpath{16,17}{2mm};
                    \draw[blue, opacity=.75] \convexpath{16,18}{2mm};
                    \draw[blue, opacity=.75] \convexpath{8,7}{2mm};
                    \draw[red, opacity=.75] \convexpath{7,6,4}{2mm};
                    \draw[darkgreen, opacity=.75] \convexpath{5,4}{2mm};
                    \draw[blue, opacity=.75] \convexpath{1,2,4,3}{2mm};
                \end{tikzpicture}
            \end{figure}
            \columnbreak
            Дерево блоков~--- точек сочленения графа слева.
            \begin{figure}[H]
                \begin{tikzpicture}
                    \graph[spring layout,node distance=1.5cm,node sep=0mm,nodes={treenode,outer sep=0mm,text width=1.5mm,as=}]{
                        1234[draw=blue] -- 4[fill=black] -- 45[draw=darkgreen],
                        4 -- 467[draw=red] -- 7[fill=black],
                        7 -- 78[draw=blue] -- 8[fill=black] -- 89[draw=darkgreen] -- 9[fill=black] -- 9101112[draw=red],
                        8 -- 813[draw=red] -- 13[fill=black] -- 131415[draw=darkgreen] -- 14[fill=black],
                        14 -- 1416[draw=red] -- 16[fill=black] -- {1617[draw=darkgreen], 1618[draw=blue]},
                    };
                \end{tikzpicture}
            \end{figure}
        \end{multicols}
    \end{example}
    \paragraph{Деревья. Остовные деревья.}
    \begin{definition}
        Неориентированный граф называется \textbf{лесом}, если в нём нет циклов.
    \end{definition}
    \begin{definition}
        Связный лес называется \textbf{деревом}.
    \end{definition}
    \begin{definition}
        Вершина степени 1 в лесе называется \textbf{листом}.
    \end{definition}
    \begin{lemma}
        Дерево с хотя бы двумя вершинами содержит лист.
    \end{lemma}
    \begin{proof}
        Рассмотрим некоторую вершину $u_1$. Если это не лист, возьмём случайного её соседа $u_2$, перейдём в него. Если это лист, мы победили. Если нет, есть хотя бы 2 соседа. Из одного мы пришли, пойдём во второго ($u_3$). Рано или поздно мы либо найдём лист, либо придём в вершину, где уже были. Во втором случае мы нашли цикл, значит такого не бывает.
    \end{proof}
    \begin{theorem}
        Следующие три утверждения равносильны:
        \begin{enumerate}
            \item $G$~--- связный граф без циклов.
            \item $G$~--- связный граф с $n$ вершинами и $n-1$ ребром.
            \item $G$~--- ациклический граф с $n$ вершинами и $n-1$ ребром.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \begin{itemize}
            \item[$1\Rightarrow2$] Докажем по индукции. В дереве на 1 вершину всё выполнено. Переход. рассмотрим граф на $n+1$ вершину. Хочется доказать, что там $n$ рёбер. Давайте рассмотрим наше дерево, найдём лист и вырежем его. Получится дерево на $n$ вершин, по предположению в нём $n-1$ ребро, а одно ребро из исходного мы вырезали, значит там их было $n$.
            \item[$2\Rightarrow3$] Если в графе $n$ вершин и $n-1$ ребро, то в нём есть вершина степени не больше одного (иначе сумма всех степеней вершин $\geqslant 2n$, значит рёбер $\geqslant\frac{2n}2=n$). У нас граф связен, поэтому вершина степени 0 там может быть только если $n=1$. А теперь можно доказать по индукции, что в графе нет циклов (таким же методом, как предыдущее).
            \item[$3\Rightarrow1$] Пусть у нас $k$ компонент связности. Каждая из них~--- ациклический связный граф, то есть дерево, в котором $m$ вершин и $m-1$ ребро. Просуммировав это по всем компонентам, получим суммарно $n$ вершин и $n-k$ рёбер, то есть $k=1$.
        \end{itemize}
    \end{proof}
    \begin{lemma}
        Дерево с хотя бы двумя вершинами содержит хотя бы два листа.
    \end{lemma}
    \begin{proof}
        В противном случае суммарная степень вершин слишком велика.
    \end{proof}
    \begin{claim}
        Разные тривиальные утверждения о том, что в дереве каждое ребро~--- мост (и если в графе каждое ребро~--- мост, то это лес), о том, что в дереве от любой вершины до любой есть ровно один путь, и все подобные сами найдите и докажите.
    \end{claim}
    \begin{definition}
        Пусть $G$~--- граф. Дерево $T$ с тем же множеством вершин и $ET\subset EG$ называется \textbf{остовным деревом} $G$.
    \end{definition}
    \begin{lemma}
        У любого связного графа есть остовное дерево.
    \end{lemma}
    \begin{proof}
        Рассмотрим граф. Из всех его связных подграфов выберем тот, у которого минимальное количество рёбер. Если рёбер там больше $n-1$, там есть циклы, из них можно вырезать рандомное ребро без потери связности. Значит рёбер там ровно $n-1$, и это дерево.
    \end{proof}
    \begin{remark}
        На алгоритмах мы будем искать остовное дерево минимального веса, а тут мы хотим рассмотреть задачу вычисления количества остовных деревьев.
    \end{remark}
    \begin{example}
        Например, сколько деревьев тут?
        \begin{figure}[H]
            \begin{tikzpicture}
                \graph[simple necklace layout,node distance=1.5cm,node sep=0mm,nodes={treenode,outer sep=0mm,text width=1.5mm,as=}]{
                    1 -- 2 -- 3 -- 4 -- 1, 1 -- 3
                };
            \end{tikzpicture}
        \end{figure}\noindent
        Ну, 8. А вообще есть такой алгоритм:
    \end{example}
    \begin{definition}
        \textbf{Матрицей Кирхгофа} графа $G$ называется матрица $K(G)$, равная
        $$
        \matr{
            \deg u_1 & 0 & 0 & \cdots & 0\\
            0 & \deg u_2 & 0 & \cdots & 0\\
            0 & 0 & \deg u_3 & \cdots & 0\\
            \vdots & \vdots & \vdots & \ddots & \vdots\\
            0 & 0 & 0 & \cdots & \deg u_n\\
        }-AG
        $$
        Где $AG$~--- матрица смежности $G$.
    \end{definition}
    \begin{example}
        Например, для графа
        \begin{figure}[H]
            \begin{tikzpicture}
                \graph[simple necklace layout,node distance=1.5cm,node sep=0mm,nodes={treenode,outer sep=0mm}]{
                    1 -- 2 -- 3 -- 4 -- 1, 1 -- 3
                };
            \end{tikzpicture}
        \end{figure}\noindent
        матрица Кирхгофа выглядит как
        $$
        \matr{
            3 & -1 & -1 & -1\\
            -1 & 2 & -1 & 0\\
            -1 & -1 & 3 & -1\\
            -1 & 0 & -1 & 2
        }
        $$
    \end{example}
    \begin{theorem}[Теорема Кирхгофа]
        \label{Теорема Кирхгофа}
        Количество остовных деревьев в графе равно алгебраическому дополнению любого элемента матрицы Кирхгофа.\\
        Во-первых, мы не будем доказывать эту теорему в общем виде, а докажем для алгебраического пополнения диагональных элементов. Во-вторых, делать мы то будем \hyperref[Доказательство теоремы Кирхгофа]{немного потом}, для доказательства нам надо будет ввести несколько новых сущностей.
    \end{theorem}
    \begin{definition}
        Пусть $G$~--- граф из $m$ рёбер и $n$ вершин. Тогда \textbf{матрицей инцидентности} $G$ называется матрица $B$ размерности $n\times m$, где в столбце, отвечающем за ребро $uv$ находятся единицы в строках номер $u$ и $v$ и нули в остальных строках.
    \end{definition}
    \begin{remark}
        Вообще матрица инцидентности~--- интересная штука. Например, давайте рассмотрим её как матрицу над $\mathbb F_2$. Что тогда происходит, если мы решим уравнение $Bx=0$? Ну, умножение её на вектор~--- сложение некоторых столбцов $B$ по модулю 2. То есть мы берём набор рёбер, и там во всех вершинах степень получается чётной.
    \end{remark}
    \begin{definition}
        Множество наборов рёбер, в которых степень каждой вершины степень чётна (т.е. $\ker B$ над $\mathbb F_2$, по сути) называется \textbf{циклическим пространством графа}.
    \end{definition}
    \begin{definition}
        Пусть $T$~--- остовное дерево $G$, $uv\notin T$. Тогда рассмотрим $T\cup uv$. Тривиально, полученный граф содержит ровано один цикл, который называется \textbf{фундаментальным циклом относительно $uv$}.
    \end{definition}
    \begin{theorem}
        Фундаментальные циклы образуют базис циклического пространства.
    \end{theorem}
    \begin{proof}
        Тривиально, они все линейно независимы (в каждом есть ровно одно ребро не из дерева, у каждого своё).\\
        Теперь докажем, что эта система порождающая. Рассмотрим $X\in\ker B$. Если $X\neq0$, то в нём, тривиально, есть цикл, а значит есть ребро не из $T$. Возможно, несколько. Так вот, давайте рассмотрим все фундаментальные циклы для каждого такого ребра и возьмём их сумму. Теперь нам надо доказать, что мы получили именно что $X$. Понятно, что все рёбра не из $T$ будут взяты 1 раз, как нам и хочется. Теперь посмотрим на рёбра $T$. Нам надо, чтобы в нём рёбра из $X$ были, а рёбер не из $X$ не было. Ну, подвесим $T$. и рассмотрим какое-то ребро $e\in T$. Если $e\in X$, то (поскольку степени всех вершин $X$ чётны) из поддерева $e$ выходит нечётное количество рёбер. То есть именно в нечётном количестве фундаментальных циклов состоит $e$, а значит оно в сумме этих циклов есть. Если же $e\notin X$, то, аналогично, циклов будет чётное количество, а значит в сумме $e$ лежать не будет.
    \end{proof}
    \begin{remark}
        Вернёмся к теореме Кирхгофа.
    \end{remark}
    \begin{definition}
        Пусть $G$~--- неориентированный граф. Тогда его \textbf{ориентацией} ($\vec G$) называется ориентированный граф, вершины которого~--- это вершины $G$, а каждое ребро является ребром $G$, ориентированным в одну из двух сторон.
    \end{definition}
    \begin{definition}
        \textbf{Матрицей инцидентности ориентированного графа} называется такая матрица $\vec B$ размерности $n\times m$, что в столбце, отвечающем за ребро $\vec{uv}$ находится единица в строке номер $v$, минус единица в строке номер $u$ и нули во всех остальных строках.
    \end{definition}
    \begin{lemma}
        Пусть $\vec G$~--- произвольная ориентация $G$. Тогда $\vec B\vec B^T=K$.
    \end{lemma}
    \begin{proof}
        Рассмотрим скалярное произведение строки $\vec B$ на столбец $\vec B^T$.
        \begin{itemize}
            \item Если они имеют одинаковый номер, то в этом скалярном произведении умножается 1 на 1 для каждого входящего ребра и $-1$ на $-1$ для исходящего. То есть суммируется столько единиц, сколько рёбер, инцидентной с данной вершиной, то есть $(\vec B\vec B^T)_{i,i}=\deg i$, как и надо.
            \item Теперь пусть мы взяли $i$-тую строку и $j$-тый столбец. Ну, смотрите. Если $i$ и $j$ не соединены ребром, то на одном и том же месте в $i$-той и $j$-той строках $\vec B$ в одинаковом месте не может быть двух не-нулей (иначе получится, что $i$-тая и $j$-тая вершина инцидентны одному ребру, а они нет). То есть в таком случае $(\vec B\vec B^T)_{i,j}=0$. Если же $i$ и $j$ связаны ребром, то у него один конец в $i$-той строке $\vec B$, в другой~--- в $j$-той, и в скалярном произведении получим $-1$. А ровно это нам и надо.
        \end{itemize}
    \end{proof}
    \begin{lemma}
        $$
        K_{\cancel{u}}^{\cancel{v}}={\vec B}_{\cancel u}{{\vec B}^T}^{\cancel{v}}
        $$
        То есть если выкинуть $u$-тую строку из $\vec B$ и $v$-тый столбец из $\vec B^T$, то их произведение будет давать $K$ без $u$-той строки и $v$-того столбца.
    \end{lemma}
    \begin{proof}
        Доказательство как в предыдущей лемме.
    \end{proof}
    \begin{lemma}
        \label{Лемма об условии на дерево через матрицу}
        Рассмотрим $\vec B$. Рассмотрим любые $n-1$ столбцов и любые $n-1$ строк. Получим матрицу $Q$ размерности $(n-1)\times(n-1)$. Тогда $\det Q$ равен нулю, если в исходном графе выбранные нами столбцы соответствовали рёбрам, содержащим цикл (в $G$) и $\pm1$ иначе.
    \end{lemma}
    \begin{proof}
        Обозначим множество оставшихся рёбер за $EQ$, а вершину, которую мы вычеркнули,~--- за $u$.
        \begin{itemize}
            \item Если $EQ$ содержит цикл, то граф, тривиально, не связен. Рассмотрим компоненту связности, не содержащую $u$. В ней сумма столбцов равна нулю, и хорошо. Ну, как хорошо. Вообще $EQ$ может не содержать ориентированного цикла, но содержать цикл $G$. Так вот, в таком случае нам придётся взять не сумму соответствующих столбцов, а алгебраическую сумму, где неправильно направленные рёбра идут с коэффициентом $-1$. Тогда мы получим-таки наш ноль, то есть линейная комбинация столбцов будет равна нулю, следовательно определитель нулевой.
            \item Теперь пусть циклов там нет. Тогда там дерево (нет циклов и $n-1$ ребро). Оно содержит 2 листа. Один из них~--- не $u$. Обзовём его $v_1$. Поскольку мы считаем определок, нам разрешают переставлять строки и столбцы матрицы: давайте возьмём строку $v_1$, в ней где-то ровно одна $\pm1$. Переместим строку на первое место, а $\pm1$~--- в первый столбец, после чего забудем о $v_1$. Оставшаяся часть~--- дерево, в нём есть два листа, один~--- не $u$, возьмём его как $v_2$. Так сделаем до посинения, получим нижне-треугольную матрицу с $\pm1$ на диагонали.
        \end{itemize}
    \end{proof}
    \begin{claim}[Формула Коши~--- Бине]
        Пусть $A$~--- матрица $r\times s$, $B$~--- матрица $s\times r$, $s\geqslant r$. Тогда
        $$
        \det(AB) = \sum\limits_{1\leqslant i_1\leqslant i_2\leqslant\cdots\leqslant i_r\leqslant s}\det A^{[i_1;\ldots;i_r]}\det B_{[i_1;\ldots;i_r]}
        $$
        Напомню, что $A^{[i_1;\ldots;i_r]}$~--- минор матрицы $A$, где выбраны столбцы $i_1;\ldots;i_r$, а $B_{[i_1;\ldots;i_r]}$~--- минор $B$,  где выбраны строки $i_1;\ldots;i_r$.\\
        Доказывать формулу мы не будем, желающие могут ознакомиться с её доказательством в любом учебнике линейной алгебры.
    \end{claim}
    \begin{remark}
        Наконец-то докажем \hyperref[Теорема Кирхгофа]{теорему Кирхгофа}. Как и было анонсировано, только для алгебраических дополнений диагональных элементов.
    \end{remark}
    \begin{proof}
        \label{Доказательство теоремы Кирхгофа}
        $$
        \det K_{\cancel{u}}^{\cancel{u}}=\det({\vec B}_{\cancel u}{{\vec B}^T}^{\cancel u})=\sum\limits_{1\leqslant i_1\leqslant\cdots\leqslant i_r\leqslant n-1}\det{\vec B}_{\cancel u}^{[i_1;\ldots;i_{n-1}]}\det{{\vec B}^T}^{\cancel u}_{[i_1;\ldots;i_{n-1}]}
        $$
        Ну, и что у нас получается? Мы перебираем все возможные наборы из $n-1$ ребра. Если набор соответствует дереву, по лемме \ref{Лемма об условии на дерево через матрицу}, $\det{\vec B}_{\cancel u}^{[i_1;\ldots;i_{n-1}]}=\pm1$, а значит ровно тому же равно $\det{{\vec B}^T}^{\cancel u}_{[i_1;\ldots;i_{n-1}]}$, и мы получаем вклад в сумму в виде единицы. Если же дереву рёбра не соответствуют, получаем ноль. Итого именно количество остовных деревьев.
    \end{proof}
    \paragraph{Эйлеровы и гамильтоновы пути и циклы.}
    \begin{definition}
        \textbf{Эйлеровым циклом/путём} называется цикл/путь, проходящий по каждому ребру ровно 1 раз.
    \end{definition}
    \begin{definition}
        \textbf{Гамильтоновым циклом/путём} называется цикл/путь, проходящий по каждой вершине ровно 1 раз.
    \end{definition}
    \begin{remark}
        С эйлеровым циклом и путём есть простой, линейный по времени алгоритм, который строит эту конструкцию (почитайте АиСД). С гамильтоновым же циклом/путём всё очень плохо. Даже для довольно узких классов графов эта задача NP-полна.
    \end{remark}
    \begin{remark}
        На существование эйлерова цикла/путь не влияют изолированные вершины, поэтому отсюда и далее во всех утверждениях про эйлеровость будем игнорировать таковые.
    \end{remark}
    \begin{definition}
        Граф называется \textbf{эйлеровым}/\textbf{полуэйлеровым}/\textbf{гамильтоновым}/\textbf{полугамильтоновым}, когда в нём есть эйлеров цикл/эйлеров путь/гамильтонов путь/гамильтонов цикл.
    \end{definition}
    \begin{remark}
        Пустые графы могут считаться как эйлеровыми, так и нет. Мы будем когда как.
    \end{remark}
    \begin{theorem}
        Неориентированный связный граф является эйлеровым тогда и только тогда, когда степени всех его вершин чётны.
    \end{theorem}
    \begin{proof}
        Индукция по количеству рёбер. Если их 0, то в данной теореме мы будем считать такой граф эйлеровым.\\
        Переход. Степень каждой вершины 2, значит в графе есть какий-то цикл. Возьмём его, и вырежем из графа все его рёбра. Граф развалится на какие-то компоненты связности, давайте для всех непустых выпишем эйлеров цикл компоненты связности. Склеим эти циклы с вырезанным в начале, получим эйлеров цикл для всего графа.\\
        В обратную сторону очевидно.
    \end{proof}
    \begin{claim}
        Граф содержит эйлеров путь тогда и только тогда, когда он связен и в нём не более 2 вершин нечётной степени.
    \end{claim}
    \begin{proof}
        Если вершин нечётной степени 0, разрежем эйлеров цикл по случайной вершине, получим путь. Одна вершина нечётной степени быть не может. Если их две, соединим их, в полученном графе построим цикл, удалим ребро. В доказательстве теоремы об эйлеровом цикле мы не опирались на отсутствие кратных рёбер, так что всё хорошо.\\
        В обратную сторону, опять же, очевидно.
    \end{proof}
    \begin{claim}
        Связный граф с $2k$ вершинами нечётной степени можно разбить на $\max\{1;k\}$ рёберно-непересекающихся путей рёберно простых путей.
    \end{claim}
    \begin{theorem}
        Ориентированный слабо связный граф содержит эйлеров цикл, если для любой вершины входящая степень равна исходящей.
    \end{theorem}
    \begin{proof}
        Аналогично теореме для неориентированных графов.
    \end{proof}
    \begin{remark}
        Сами сформулируйте аналоги утверждений про эйлеров путь и разбиение на пути для ориентированных графов.
    \end{remark}
    \begin{remark}
        Отсюда и дальше в критериях гамильтоновости считаем, что наши графы связны и содержат хотя бы 3 вершины.
    \end{remark}
    \begin{theorem}[Теорема Дирака]
        Пусть $G$~--- связный граф с хотя бы 3 вершинами. Если степень любой его вершины $\geqslant\frac n2$, то граф гамильтонов.
    \end{theorem}
    \begin{theorem}[Теорема Оре]
        Пусть $G$~--- связный граф с хотя бы 3 вершинами. Если для любых двух его несмежных вершин $u,v~\deg u+\deg v\geqslant n$, то граф гамильтонов.
    \end{theorem}
    \begin{theorem}[Теорема Хватала]
        Пусть $G$~--- связный граф с хотя бы 3 вершинами. Пусть его степени вершин~--- $d_1\leqslant d_2\leqslant\cdots\leqslant d_n$. Если выполнено условие
        $$
        d_k\leqslant k<\frac n2\rightarrow d_{n-k}\geqslant n-k
        $$
        то $G$~--- гамильтонов.
    \end{theorem}
    \begin{proof}
        Для начала условие
        $$
        d_k\leqslant k<\frac n2\rightarrow d_{n-k}\geqslant n-k
        $$
        назовём $(*)$.\\
        Итак, пусть $G$~--- негамильтонов граф, в котором $(*)$.
        \begin{lemma}
            Пусть $G$ выполнено $(*)$, $uv\notin E$. Тогда $G\cup\{uv\}$ также $(*)$.
        \end{lemma}
        \begin{proof}
            Пусть мы имели
            $$d_1\leqslant d_2\leqslant\cdots\leqslant d_n$$
            Мы увеличили на 1 $d_u$ и $d_v$. После пересортировки они переедут после всех вершин, которые имели степень ровно $d_u$/$d_v$ соотвественно. Давайте заметим, что $d_i\leqslant d'_i$, если трактовать $i$ как номера. Ну, и хорошо, от этого условия мы как раз и понимаем, что $(*)$.
        \end{proof}
        Из всех графов, для которых не выполняется теорема Хватала, рассмотрим граф, у которого наименьшее количество вершин, а из всех таких граф с наибольшим количеством рёбер. Во-первых, это не полный граф, иначе граф гамильтонов. Тогда возьмём ребро, которого в графе нет. Пусть это ребро $uv$. Очевидно, $G\cup\{uv\}$ гамильтонов (мы брали максимальное количество рёбер). Давайте тогда выберем не просто $u,v$, а такие, что $\deg u+\deg v$ максимально. Итак, $G\cup\{uv\}$ гамильтонов, а значит $G$~--- полугамильтонов. Давайте тогда вдоль пути пронумеруем вершины: $u=u_1\to u_2\to\cdots\to u_{n-1}\to u_n=v$.\\
        Введём множество $S=\{i\in[1:n]\mid uu_i\in E\}$. Понятно, что $S\subset\{2,3,\ldots,n-1\}$. Введём множество $T=\{i\in[1:n]\mid u_{i-1}v\in E\}\subset\{3,4,\ldots,n\}$. Понятно, $|S|=\deg u$, $|T|=\deg v$. Менее понятно, $S\cap T=\varnothing$. Почему так? Если они пересекаются по $i$, то есть гамильтонов цикл
        $$u\to u_2\to u_3\to\cdots\to u_{i-1}\to v\to u_{n-1}\to u_{n-2}\to\cdots\to u_i\to u$$
        Отсюда $\deg u+\deg v\leqslant n-1$.\\
        Не умаляя общности давайте считать, что $\deg u\leqslant\deg v$. Тогда $\deg u=k<\frac n2$. Рассмотрим множество вершин $\{u_{i-1}\mid i\in S\}$. По условию $S\cap T=\varnothing$, для каждой $u_{i-1}v\notin E$. Заметим, что степень каждой вершины $\deg u_{i-1}\leqslant k$. А значит, у нас существует хотя бы $k$ вершин степени $\leqslant k$. Отсюда $d_k\leqslant k<\frac n2$. По $(*)$ отсюда следует, что $d_{n-k}\geqslant n-k$. То есть существует хотя бы $k+1$ вершина степени $\geqslant n-k$ (с номерами от $n-k$ до $n$ включительно). А отсюда $\exists w~uw\notin E\land\deg w\geqslant n-k$. А тогда $\deg u+\deg w\geqslant n$~--- противоречие с выбором $v$.
    \end{proof}
    \begin{theorem}[Обратная к теореме Хватала]
        Если $n\geqslant 3$ и $d_1\leqslant d_2\leqslant\cdots\leqslant d_n$~--- последовательность, для которой не выполнено $(*)$, то существует негамильтонов граф, для которого $d_1,\ldots d_n$ являются степенной последовательностью.\\
        Доказательство данной теоремы оставляется читателю.
    \end{theorem}
    \begin{theorem}[Теорема Гуйа~--- Ури]
        Рассмотрим ориентированный граф. Если для любой вершины её входящая и исходящая степень больше либо равны $\frac n2$, то $G$~--- гамильтонов.\\
        Тоже оставляется читателю.
    \end{theorem}
    \begin{definition}
        Граф называется турниром, если он является ориентацией полного графа.
    \end{definition}
    \begin{theorem}[Теорема Релеи~--- Камеона]
        Любой сильно связный турнир содержит гамильтонов цикл.\\
        Также оставляется читателю.
    \end{theorem}
    \paragraph{Укладки графов. Планарность.}
    \begin{remark}
        Концептуально мы рассматриваем достаточно хорошее многообразие и пытаемся уложить на нём граф. <<Хорошее>> — не надо треугольников Серпинского, непрерывных нигде не гладких многообразий, тороидов с бесконечным числом дырок и т.п. Не очень интересно всё это формализовать, и мы не будем.
    \end{remark}
    \begin{definition}
        Пусть $X$~--- <<достаточно хорошее>> многообразие, $G$~--- граф. Тогда его \textbf{вложением} в $X$ называется отображения $p\colon V\to X$ и $q\colon E\to C_X$ (множество всех кривых в $X$), при этом никакие две кривые, соответствующие рёбрам, не пересекаются кроме как в вершине, и две кривые пересекаются в вершине только тогда,
        когда они оба инцидентны этой вершине.
    \end{definition}
    \begin{theorem}
        Любой граф вкладываем в $\mathbb R^3$.
    \end{theorem}
    \begin{proof}
        Давайте возьмём случайное расположение вершин и соединим их прямыми. Вероятность пересечения~--- ноль (как минимум потому, что нам необходимо, чтобы 4 точки лежали в одной плоскости, а у этого нулевая вероятность).
    \end{proof}
    \begin{proof}
        Давайте расположим вершины по окружности, для каждой вершины $u$ выделим
        $\deg u$ прямых (близких к вертикальной), и если у нас не получается провести ребро в плоскости, на разную высоту будем подниматься (вдоль правильной прямой), и там проводим ребро.
    \end{proof}
    \begin{claim}
        Любая замкнутая кривая без самопересечений и самокасаний делит плоскость на две части: конечную и бесконечную.
    \end{claim}
    \begin{definition}
        У условиях предыдущего утверждения конечную часть будем называть \textbf{внутренней}, бесконечную~--- \textbf{внешней}.
    \end{definition}
    \begin{claim}
        При наличии замкнутой кривой без самопересечений и самокасаний любые две точки в одной части разбиения можно соединить <<достаточно хорошей кривой>>.
    \end{claim}
    \begin{definition}
        Граф, вложимый в $\mathbb R^2$, называется \textbf{планарным}.
    \end{definition}
    \begin{definition}
        Укладка планарного графа называется \textbf{плоским графом}.
    \end{definition}
    \begin{definition}
        Плоский граф разбивает плоскости на какие-то связные области. Эти области называются \textbf{гранями}.
    \end{definition}
    \begin{theorem}[Формула Эйлера]
        Пусть в связном планарном графе $V$ вершин и $E$ рёбер, а при его
        укладке на плоскости получилось $F$ граней. Тогда
        $$V+F-E=2$$
    \end{theorem}
    \begin{proof}
        Докажем индукцией по количеству вершин и рёбер. Если у нас 1 вершина и 0 рёбер,
        то грань там тоже одна.\\
        Пусть у нас не 1 вершина. Если наш граф дерево, у него $n$ вершин, $n-1$ ребро и 1 грань. Если наш
        граф не дерево, у нас есть хоть один не-мост. Тогда он лежит в цикле, а значит при удалении этого
        ребра у нас уменьшится количество граней на 1. При этом граф останется связным. Из индукционного
        предположения $V+(F-1)-(E-1)=2$, всё.
    \end{proof}
    \begin{corollary}
        Если планарный граф имеет $k$ компонент связности, $V$ вершин, $E$ рёбер, а при его
        укладке получилось $F$ граней, то
        $$F+V-E=k+1$$
    \end{corollary}
    \begin{lemma}
        Граф $K_5$ не планарен.
    \end{lemma}
    \begin{proof}
        Пусть он планарен. Тогда для любой его укладки верна формула Эйлера. То есть уложив его на плоскости, получим $F=7$. Посмотрим на эти грани. Каждая окружается каким-то циклом, а цикл содержит хотя бы 3 ребра. То есть сумма длин циклов вокруг граней больше либо равна 21. С другой стороны, каждое ребро входит в 2 цикла. А значит у нас $\geqslant10.5$ рёбер. Ой.
    \end{proof}
    \begin{claim}
        В планарном графе $E\leqslant3V-6$.
    \end{claim}
    \begin{proof}
        В доказательстве предыдущей теоремы мы выяснили, что $F=2-V+E$ и $2E\geqslant 2F$. Отсюда следует то, что мы хотели доказать.
    \end{proof}
    \begin{lemma}
        $K_{3,3}$ не планарен.
    \end{lemma}
    \begin{proof}
        Пусть он планарен. Тогда, для него верна формула Эйлера. То есть уложив его на плоскости, получим $F=5$. Посмотрим на эти грани. Каждая окружается каким-то циклом, а \underline{цикл содержит хотя бы 4 ребра, потому что граф двудолен}. То есть сумма длин циклов вокруг граней больше либо равна 20. С другой стороны, каждое ребро входит в 2 цикла. А значит у нас $\geqslant10$ рёбер. Ой.
    \end{proof}
    \begin{remark}
        Оказывается, каждый не планарный граф содержит внутри себя $K_5$ или $K_{3,3}$. Но содержит весьма специфичным образом. Сейчас опишем, каким.
    \end{remark}
    \begin{definition}
        Граф $G_1$ \textbf{гомеоморфен} графу $G_2$, если $\exists G_3$ изоморфный $G_1$ такой что его можно получить из $G_2$ конечным количеством следующих операций: убрать вершину степени 2 и соединить её соседей либо, наоборот, убрать ребро и заменить его вершиной степени 2, соединённой с концами удалённого ребра.
    \end{definition}
    \begin{remark}
        Гомеоморфность, на самом деле,~--- эквивалентность топологический пространств. Как это вообще с графами связано? А вот как:\\
        Граф можно сделать топологическим пространством. У нас вершины будут точками, а
        рёбра~--- бесконечно тонкими нитками. И тогда у вершины будет окрестность из маленьких кусочков инцидентных её рёбер, а ещё будут окрестности на ребре. Вот это всё чудо является базой топологии на графах. При этом, очевидно, у нас ничего не меняется в окрестностях, если мы добавляем либо убираем вершину степени 2, а значит в качестве гомеоморфности на графах мы имеем именно то определение, что написано выше.
    \end{remark}
    \begin{property}
        Гомеоморфные графы либо одновременно планарны, либо одновременно нет.
    \end{property}
    \begin{proof}
        Тривиально.
    \end{proof}
    \begin{lemma}
        Дерево планарно.
    \end{lemma}
    \begin{proof}
        Подвесим дерево. Теперь сопоставим каждой вершине отрезок вот так: корню соответствует $[0; 1]$, для детей берём их родителя и делим его отрезок на столько частей, сколько детей. После этого расположим вершины одного уровня на одной вертикали, а по горизонтали в их отрезок. Нетрудно заметить, что получится плоский граф.
    \end{proof}
    \begin{lemma}
        Граф планарен тогда и только тогда, когда его можно уложить на сфере.
    \end{lemma}
    \begin{proof}
        Для начала предъявим гомеоморфизм сферы без точки и плоскости. Возьмём сферу, положим южным полюсом на плоскости, и будем проводит прямые через северный полюс. Они соединяют ещё одну точку сферы с точкой плоскости, вот это и нужное нам отображение. Тривиально, оно непрерывно и биективно (и обратное к нему непрерывно).\\
        Тогда по этой биекции располагаем граф, и получаем то, что мы хотим.
    \end{proof}
    \begin{lemma}
        Для любой вершины $u$ существует укладка $G$ на плоскости, что $u$~--- вершина внешней грани.
    \end{lemma}
    \begin{proof}
        Уложим граф на сферу, возьмём сферу в руки и повернём сферу так, чтобы верхняя грань содержала $u$. Разложим обратно из сферы на плоскости.
    \end{proof}
    \begin{lemma}
        Для любого ребра $uv$ существует укладка $G$ на плоскости, что $uv$~--- ребро внешней грани.
    \end{lemma}
    \begin{proof}
        Аналогично предыдущему.
    \end{proof}
    \begin{lemma}
        \label{lmm:Граф планарен тогда и только тогда, когда все его компоненты рёберной двусвязности планарны.}
        Граф планарен тогда и только тогда, когда все его компоненты рёберной двусвязности планарны.
    \end{lemma}
    \begin{proof}
        В одну сторону очевидно, в другую раскладываем по индукции по количеству компонент.\\
        Если компонент одна, понятно, если несколько, уберём ту, которая в дереве мостов~--- лист. По индукции расположим остаток так, чтобы вершина, к которой соединён мост, оказалась на внешней грани. Соединим с удалённой компонентой рёберной двусвязности.
    \end{proof}
    \begin{lemma}
        \label{lmm:Граф планарен тогда и только тогда, когда все его компоненты вершинной двусвязности планарны.}
        Граф планарен тогда и только тогда, когда все его компоненты вершинной двусвязности планарны.
    \end{lemma}
    \begin{proof}
        Доказательство. Опять же, в одну сторону очевидно, в другую по индукции. База~--- очевидно, переход~--- аналогично.
    \end{proof}
    \begin{theorem}[Теорема Понтрягина~--- Куратовского]
        Граф планарен тогда и только тогда, когда у него не существует подграфа, гомеоморфного $K_5$ или $K_{3,3}$.
    \end{theorem}
    \begin{proof}
        Влево очевидно, а вправо придётся страдать.\\
        Нам надо доказать, что граф без $K_5$ и $K_{3,3}$ планарен. Пусть это не так. Тогда давайте из всех таких графов рассмотрим граф $G$, у которого минимальное количество вершин. Если таких несколько, возьмём с минимальным количеством рёбер. Тогда пусть $uv$~--- ребро. При его удалении $K_5$ или $K_{3,3}$ не появится, а рёбер станет меньше, значит $G\setminus uv$ планарен.
        \begin{lemma}
            $G\setminus uv$ не содержит мостов и точек сочленения.
        \end{lemma}
        \begin{proof}
            Заметим, что по минимальности $G$ и леммам \ref{lmm:Граф планарен тогда и только тогда, когда все его компоненты рёберной двусвязности планарны.} и \ref{lmm:Граф планарен тогда и только тогда, когда все его компоненты вершинной двусвязности планарны.} сам $G$ не содержит мостов и точек сочленения. А значит, если $G\setminus uv$ содержит, то $u$ и $v$ лежат в разных компонентах двусвязности. Пусть $G\setminus uv$ содержит мост $ab$.
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Ellipse [id:dp9619429247773177] 
                    \draw   (111.8,128.5) .. controls (111.8,77.41) and (132.39,36) .. (157.8,36) .. controls (183.21,36) and (203.8,77.41) .. (203.8,128.5) .. controls (203.8,179.59) and (183.21,221) .. (157.8,221) .. controls (132.39,221) and (111.8,179.59) .. (111.8,128.5) -- cycle ;
                    %Shape: Ellipse [id:dp1600598469749579] 
                    \draw   (406.8,134.5) .. controls (406.8,83.41) and (427.39,42) .. (452.8,42) .. controls (478.21,42) and (498.8,83.41) .. (498.8,134.5) .. controls (498.8,185.59) and (478.21,227) .. (452.8,227) .. controls (427.39,227) and (406.8,185.59) .. (406.8,134.5) -- cycle ;
                    %Shape: Circle [id:dp4680554308214795] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (171,90.4) .. controls (171,87.42) and (173.42,85) .. (176.4,85) .. controls (179.38,85) and (181.8,87.42) .. (181.8,90.4) .. controls (181.8,93.38) and (179.38,95.8) .. (176.4,95.8) .. controls (173.42,95.8) and (171,93.38) .. (171,90.4) -- cycle ;
                    %Shape: Circle [id:dp3544158038838776] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (158.5,172.4) .. controls (158.5,169.42) and (160.92,167) .. (163.9,167) .. controls (166.88,167) and (169.3,169.42) .. (169.3,172.4) .. controls (169.3,175.38) and (166.88,177.8) .. (163.9,177.8) .. controls (160.92,177.8) and (158.5,175.38) .. (158.5,172.4) -- cycle ;
                    %Shape: Circle [id:dp5929980589363897] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (439.5,101.9) .. controls (439.5,98.92) and (441.92,96.5) .. (444.9,96.5) .. controls (447.88,96.5) and (450.3,98.92) .. (450.3,101.9) .. controls (450.3,104.88) and (447.88,107.3) .. (444.9,107.3) .. controls (441.92,107.3) and (439.5,104.88) .. (439.5,101.9) -- cycle ;
                    %Shape: Circle [id:dp694420722485745] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (451,185.4) .. controls (451,182.42) and (453.42,180) .. (456.4,180) .. controls (459.38,180) and (461.8,182.42) .. (461.8,185.4) .. controls (461.8,188.38) and (459.38,190.8) .. (456.4,190.8) .. controls (453.42,190.8) and (451,188.38) .. (451,185.4) -- cycle ;
                    %Straight Lines [id:da48039706041655617] 
                    \draw    (163.9,172.4) -- (456.4,185.4) ;
                    %Straight Lines [id:da3097592848427295] 
                    \draw    (176.4,90.4) -- (444.9,101.9) ;

                    % Text Node
                    \draw (164.86,68.9) node [anchor=north west][inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (450.86,80.4) node [anchor=north west][inner sep=0.75pt]    {$b$};
                    % Text Node
                    \draw (148.86,150.4) node [anchor=north west][inner sep=0.75pt]    {$u$};
                    % Text Node
                    \draw (462.36,165.4) node [anchor=north west][inner sep=0.75pt]    {$v$};
                \end{tikzpicture}
            \end{figure}\noindent
            Тогда сделаем вот такое преобразование:
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Ellipse [id:dp9619429247773177] 
                    \draw   (111.8,128.5) .. controls (111.8,77.41) and (132.39,36) .. (157.8,36) .. controls (183.21,36) and (203.8,77.41) .. (203.8,128.5) .. controls (203.8,179.59) and (183.21,221) .. (157.8,221) .. controls (132.39,221) and (111.8,179.59) .. (111.8,128.5) -- cycle ;
                    %Shape: Ellipse [id:dp1600598469749579] 
                    \draw   (406.8,134.5) .. controls (406.8,83.41) and (427.39,42) .. (452.8,42) .. controls (478.21,42) and (498.8,83.41) .. (498.8,134.5) .. controls (498.8,185.59) and (478.21,227) .. (452.8,227) .. controls (427.39,227) and (406.8,185.59) .. (406.8,134.5) -- cycle ;
                    %Shape: Circle [id:dp4680554308214795] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (171,90.4) .. controls (171,87.42) and (173.42,85) .. (176.4,85) .. controls (179.38,85) and (181.8,87.42) .. (181.8,90.4) .. controls (181.8,93.38) and (179.38,95.8) .. (176.4,95.8) .. controls (173.42,95.8) and (171,93.38) .. (171,90.4) -- cycle ;
                    %Shape: Circle [id:dp3544158038838776] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (158.5,172.4) .. controls (158.5,169.42) and (160.92,167) .. (163.9,167) .. controls (166.88,167) and (169.3,169.42) .. (169.3,172.4) .. controls (169.3,175.38) and (166.88,177.8) .. (163.9,177.8) .. controls (160.92,177.8) and (158.5,175.38) .. (158.5,172.4) -- cycle ;
                    %Shape: Circle [id:dp5929980589363897] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (439.5,101.9) .. controls (439.5,98.92) and (441.92,96.5) .. (444.9,96.5) .. controls (447.88,96.5) and (450.3,98.92) .. (450.3,101.9) .. controls (450.3,104.88) and (447.88,107.3) .. (444.9,107.3) .. controls (441.92,107.3) and (439.5,104.88) .. (439.5,101.9) -- cycle ;
                    %Shape: Circle [id:dp694420722485745] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (451,185.4) .. controls (451,182.42) and (453.42,180) .. (456.4,180) .. controls (459.38,180) and (461.8,182.42) .. (461.8,185.4) .. controls (461.8,188.38) and (459.38,190.8) .. (456.4,190.8) .. controls (453.42,190.8) and (451,188.38) .. (451,185.4) -- cycle ;
                    %Curve Lines [id:da07799184864792963] 
                    \draw    (176.4,90.4) .. controls (290.55,71) and (317.55,205) .. (163.9,172.4) ;

                    % Text Node
                    \draw (164.86,68.9) node [anchor=north west][inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (450.86,80.4) node [anchor=north west][inner sep=0.75pt]    {$b$};
                    % Text Node
                    \draw (148.86,150.4) node [anchor=north west][inner sep=0.75pt]    {$u$};
                    % Text Node
                    \draw (462.36,165.4) node [anchor=north west][inner sep=0.75pt]    {$v$};
                \end{tikzpicture}
            \end{figure}\noindent
            Утверждается, что каждая из компонент связности (например, левая) не содержит $K_5$ и $K_{3,3}$. Почему? Ну, пусть содержит. Тогда $au$~--- ребро такого подграфа. А давайте вместо него возьмём $u\to v\leadsto b\to a$ в исходном графе и сожмём в одно ребро (по определению гомеоморфности мы так можем). Получим, что исходный граф тоже содержал $K_5$ или $K_{3,3}$. Поскольку в левой компоненте связности меньше рёбер, чем в $G$, она планарна. А значит её можно уложить так, чтобы $au$ было на внешней грани. То же самое сделаем с правой компонентой связности
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Circle [id:dp4680554308214795] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (236,95.4) .. controls (236,92.42) and (238.42,90) .. (241.4,90) .. controls (244.38,90) and (246.8,92.42) .. (246.8,95.4) .. controls (246.8,98.38) and (244.38,100.8) .. (241.4,100.8) .. controls (238.42,100.8) and (236,98.38) .. (236,95.4) -- cycle ;
                    %Shape: Circle [id:dp3544158038838776] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (208.5,190.4) .. controls (208.5,187.42) and (210.92,185) .. (213.9,185) .. controls (216.88,185) and (219.3,187.42) .. (219.3,190.4) .. controls (219.3,193.38) and (216.88,195.8) .. (213.9,195.8) .. controls (210.92,195.8) and (208.5,193.38) .. (208.5,190.4) -- cycle ;
                    %Shape: Circle [id:dp5929980589363897] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (342.5,103.9) .. controls (342.5,100.92) and (344.92,98.5) .. (347.9,98.5) .. controls (350.88,98.5) and (353.3,100.92) .. (353.3,103.9) .. controls (353.3,106.88) and (350.88,109.3) .. (347.9,109.3) .. controls (344.92,109.3) and (342.5,106.88) .. (342.5,103.9) -- cycle ;
                    %Shape: Circle [id:dp694420722485745] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (354,187.4) .. controls (354,184.42) and (356.42,182) .. (359.4,182) .. controls (362.38,182) and (364.8,184.42) .. (364.8,187.4) .. controls (364.8,190.38) and (362.38,192.8) .. (359.4,192.8) .. controls (356.42,192.8) and (354,190.38) .. (354,187.4) -- cycle ;
                    %Curve Lines [id:da5418433075198561] 
                    \draw    (213.9,190.4) .. controls (85.55,220) and (125.55,1) .. (241.4,95.4) ;
                    %Straight Lines [id:da4600459397491037] 
                    \draw    (241.4,95.4) -- (213.9,190.4) ;
                    %Straight Lines [id:da3893539151760381] 
                    \draw    (347.9,103.9) -- (359.4,187.4) ;
                    %Curve Lines [id:da5543315017764847] 
                    \draw    (359.4,187.4) .. controls (469.55,279) and (521.55,-5) .. (347.9,103.9) ;

                    % Text Node
                    \draw (243.4,92) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (345.9,100.5) node [anchor=south east] [inner sep=0.75pt]    {$b$};
                    % Text Node
                    \draw (211.9,187) node [anchor=south east] [inner sep=0.75pt]    {$u$};
                    % Text Node
                    \draw (357.4,184) node [anchor=south east] [inner sep=0.75pt]    {$v$};
                \end{tikzpicture}
            \end{figure}\noindent
            А после этого мы можем удалить обратно добавленные рёбра $au$ и $bv$, но добавить два удалённых ребра $ab$ и $uv$, получив, что исходный граф был планарен, тем самым получив противоречие с наличием моста в $G\setminus uv$.\\
            Доказательство отсутствия точек сочленения аналогично.
        \end{proof}
        Отсюда получается, что $uv$ лежат на цикле в графе $G\setminus uv$. Почему? Потому что возьмём два любых ребра, инцидентных $u$ и $v$ соотвественно, по лемме эти рёбра вершинно двусвязны, а значит лежат на цикле.\\
        Давайте среди всех циклов, на которых лежат $uv$ и для всех укладок графа $G\setminus uv$ на плоскости возьмём тот цикл $C$ и ту укладку, что внутри $C$ находится максимальное количество граней. Несмотря на то, что укладок у нас бесконечно много, взять максимум мы можем, потому что граней у нас в принципе конечное число, а значит укладки разбиваются на классы эквивалентности по количеству граней внутри $C$.\\
        Давайте удалим наш цикл. Что останется от графа? Какие-то компоненты связности. Очевидно, каждая компонента лежит либо полностью внутри цикла, либо полностью вне (иначе рёбра пересекаются). Как они лежат в графе? Ну, как-то так:
        \begin{figure}[H]
            \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                %Straight Lines [id:da09816083328065961] 
                \draw    (357.8,88.2) -- (461.64,94.6) ;
                %Straight Lines [id:da6576223354128274] 
                \draw    (456.84,123) -- (361.4,171.4) ;
                %Straight Lines [id:da3246672730852964] 
                \draw    (329.6,49) -- (291.24,115.16) ;
                %Straight Lines [id:da3647321560487098] 
                \draw    (361.4,171.4) -- (291.24,157.56) ;
                %Straight Lines [id:da21362559206306475] 
                \draw    (149.6,179.4) -- (221.64,141.96) ;
                %Shape: Circle [id:dp9084690040636754] 
                \draw   (140,133.77) .. controls (140,70.94) and (190.94,20) .. (253.77,20) .. controls (316.61,20) and (367.55,70.94) .. (367.55,133.77) .. controls (367.55,196.61) and (316.61,247.55) .. (253.77,247.55) .. controls (190.94,247.55) and (140,196.61) .. (140,133.77) -- cycle ;
                %Shape: Circle [id:dp5901768406782604] 
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (177.2,45) .. controls (177.2,42.02) and (179.62,39.6) .. (182.6,39.6) .. controls (185.58,39.6) and (188,42.02) .. (188,45) .. controls (188,47.98) and (185.58,50.4) .. (182.6,50.4) .. controls (179.62,50.4) and (177.2,47.98) .. (177.2,45) -- cycle ;
                %Shape: Circle [id:dp050894915611129576] 
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (180,223.8) .. controls (180,220.82) and (182.42,218.4) .. (185.4,218.4) .. controls (188.38,218.4) and (190.8,220.82) .. (190.8,223.8) .. controls (190.8,226.78) and (188.38,229.2) .. (185.4,229.2) .. controls (182.42,229.2) and (180,226.78) .. (180,223.8) -- cycle ;
                %Shape: Ellipse [id:dp6351442582714808] 
                \draw   (221,136.5) .. controls (221,120.76) and (239.76,108) .. (262.9,108) .. controls (286.04,108) and (304.8,120.76) .. (304.8,136.5) .. controls (304.8,152.24) and (286.04,165) .. (262.9,165) .. controls (239.76,165) and (221,152.24) .. (221,136.5) -- cycle ;
                %Shape: Circle [id:dp06668840166642509] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (324.2,49) .. controls (324.2,46.02) and (326.62,43.6) .. (329.6,43.6) .. controls (332.58,43.6) and (335,46.02) .. (335,49) .. controls (335,51.98) and (332.58,54.4) .. (329.6,54.4) .. controls (326.62,54.4) and (324.2,51.98) .. (324.2,49) -- cycle ;
                %Shape: Circle [id:dp08762646360449144] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (356,171.4) .. controls (356,168.42) and (358.42,166) .. (361.4,166) .. controls (364.38,166) and (366.8,168.42) .. (366.8,171.4) .. controls (366.8,174.38) and (364.38,176.8) .. (361.4,176.8) .. controls (358.42,176.8) and (356,174.38) .. (356,171.4) -- cycle ;
                %Shape: Circle [id:dp9887746533272483] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (144.2,179.4) .. controls (144.2,176.42) and (146.62,174) .. (149.6,174) .. controls (152.58,174) and (155,176.42) .. (155,179.4) .. controls (155,182.38) and (152.58,184.8) .. (149.6,184.8) .. controls (146.62,184.8) and (144.2,182.38) .. (144.2,179.4) -- cycle ;
                %Shape: Circle [id:dp8391128746432603] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (352.4,88.2) .. controls (352.4,85.22) and (354.82,82.8) .. (357.8,82.8) .. controls (360.78,82.8) and (363.2,85.22) .. (363.2,88.2) .. controls (363.2,91.18) and (360.78,93.6) .. (357.8,93.6) .. controls (354.82,93.6) and (352.4,91.18) .. (352.4,88.2) -- cycle ;
                %Shape: Ellipse [id:dp16105115201202969] 
                \draw   (457,117.1) .. controls (457,92.41) and (473.53,72.4) .. (493.92,72.4) .. controls (514.31,72.4) and (530.84,92.41) .. (530.84,117.1) .. controls (530.84,141.79) and (514.31,161.8) .. (493.92,161.8) .. controls (473.53,161.8) and (457,141.79) .. (457,117.1) -- cycle ;

                % Text Node
                \draw (183.4,227.2) node [anchor=north east] [inner sep=0.75pt]    {$v$};
                % Text Node
                \draw (180.6,41.6) node [anchor=south east] [inner sep=0.75pt]    {$u$};
                % Text Node
                \draw (262.9,136.5) node    {$\mathrm{In}$};
                % Text Node
                \draw (493.92,117.1) node    {$\mathrm{Out}$};
            \end{tikzpicture}
        \end{figure}\noindent
        Если у нас вершины цикла соединены между собой напрямую, будем считать, что между ними просто внешняя или внутренняя компонента из 0 вершин. Или можно вставить туда вершину степени 2 (у нас же всё работает с точностью до гомеоморфзма). При этом и внешних, и внутренних компонент есть хотя бы одна, иначе $G$ планарен (мы можем соединить $u$ и $v$ либо снаружи, либо внутри ребром).\\
        Заметим, что у нас цикл $C$ мы можем разделить на 2 участка, на 2 пути от $u$ до $v$. На картинке есть левая часть цикла и правая. Так вот,
        \begin{lemma}
            Каждая внешняя компонента подсоединяется к циклу ровно в двух точках. Причём эти две точки лежат на разных частях цикла.
        \end{lemma}
        \begin{proof}
            В одной не может быть, потому что это точка сочленения. Если не в одной и либо не в двух, либо в двух, но с одной стороны, то две вершины с одной стороны точно есть, а значит в качестве цикла $C$ мы могли взять вот такой, у которого внутри больше граней.
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Arc [id:dp35477129704802923] 
                    \draw  [draw opacity=0] (361.24,171.22) .. controls (345.76,215.66) and (303.49,247.55) .. (253.77,247.55) .. controls (190.94,247.55) and (140,196.61) .. (140,133.77) .. controls (140,70.94) and (190.94,20) .. (253.77,20) .. controls (300.86,20) and (341.27,48.61) .. (358.57,89.4) -- (253.77,133.77) -- cycle ; \draw  [color={rgb, 255:red, 0; green, 49; blue, 255 }  ,draw opacity=1 ] (361.24,171.22) .. controls (345.76,215.66) and (303.49,247.55) .. (253.77,247.55) .. controls (190.94,247.55) and (140,196.61) .. (140,133.77) .. controls (140,70.94) and (190.94,20) .. (253.77,20) .. controls (300.86,20) and (341.27,48.61) .. (358.57,89.4) ;  
                    %Straight Lines [id:da09816083328065961] 
                    \draw [color={rgb, 255:red, 0; green, 49; blue, 255 }  ,draw opacity=1 ]   (357.8,88.2) -- (461.64,94.6) ;
                    %Straight Lines [id:da6576223354128274] 
                    \draw [color={rgb, 255:red, 0; green, 49; blue, 255 }  ,draw opacity=1 ]   (456.84,123) -- (361.4,171.4) ;
                    %Shape: Arc [id:dp13748444086462186] 
                    \draw  [draw opacity=0] (357.78,87.58) .. controls (364.06,101.69) and (367.55,117.33) .. (367.55,133.77) .. controls (367.55,146.95) and (365.3,159.61) .. (361.18,171.39) -- (253.77,133.77) -- cycle ; \draw   (357.78,87.58) .. controls (364.06,101.69) and (367.55,117.33) .. (367.55,133.77) .. controls (367.55,146.95) and (365.3,159.61) .. (361.18,171.39) ;  
                    %Shape: Circle [id:dp5901768406782604] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (177.2,45) .. controls (177.2,42.02) and (179.62,39.6) .. (182.6,39.6) .. controls (185.58,39.6) and (188,42.02) .. (188,45) .. controls (188,47.98) and (185.58,50.4) .. (182.6,50.4) .. controls (179.62,50.4) and (177.2,47.98) .. (177.2,45) -- cycle ;
                    %Shape: Circle [id:dp050894915611129576] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (180,223.8) .. controls (180,220.82) and (182.42,218.4) .. (185.4,218.4) .. controls (188.38,218.4) and (190.8,220.82) .. (190.8,223.8) .. controls (190.8,226.78) and (188.38,229.2) .. (185.4,229.2) .. controls (182.42,229.2) and (180,226.78) .. (180,223.8) -- cycle ;
                    %Shape: Circle [id:dp08762646360449144] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (356,171.4) .. controls (356,168.42) and (358.42,166) .. (361.4,166) .. controls (364.38,166) and (366.8,168.42) .. (366.8,171.4) .. controls (366.8,174.38) and (364.38,176.8) .. (361.4,176.8) .. controls (358.42,176.8) and (356,174.38) .. (356,171.4) -- cycle ;
                    %Shape: Circle [id:dp8391128746432603] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (352.4,88.2) .. controls (352.4,85.22) and (354.82,82.8) .. (357.8,82.8) .. controls (360.78,82.8) and (363.2,85.22) .. (363.2,88.2) .. controls (363.2,91.18) and (360.78,93.6) .. (357.8,93.6) .. controls (354.82,93.6) and (352.4,91.18) .. (352.4,88.2) -- cycle ;
                    %Shape: Ellipse [id:dp16105115201202969] 
                    \draw   (457,117.1) .. controls (457,92.41) and (473.53,72.4) .. (493.92,72.4) .. controls (514.31,72.4) and (530.84,92.41) .. (530.84,117.1) .. controls (530.84,141.79) and (514.31,161.8) .. (493.92,161.8) .. controls (473.53,161.8) and (457,141.79) .. (457,117.1) -- cycle ;
                    %Curve Lines [id:da944860984134889] 
                    \draw [color={rgb, 255:red, 0; green, 49; blue, 255 }  ,draw opacity=1 ]   (456.84,123) .. controls (465.8,130) and (506.8,80) .. (461.64,94.6) ;

                    % Text Node
                    \draw (183.4,227.2) node [anchor=north east] [inner sep=0.75pt]    {$v$};
                    % Text Node
                    \draw (180.6,41.6) node [anchor=south east] [inner sep=0.75pt]    {$u$};
                    % Text Node
                    \draw (493.92,117.1) node    {$\mathrm{Out}$};
                \end{tikzpicture}
            \end{figure}\noindent
        \end{proof}
        А отсюда следует, что на внутренних компонентах есть естественный порядок. Если есть две компоненты, то у одной обе точки присоединения ближе к $u$, а у другой~--- ближе к $v$.\\
        А что мы можем сказать про внутренние компоненты? Ну, с ними уже всё не так понятно. Но введём пару определений
        \begin{definition}
            Будем говорить, что внутренняя часть $\mathrm{In}$ разделяет $u$ и $v$, если у неё существуют две точки подключения по разные стороны цикла $C$.
        \end{definition}
        \begin{definition}
            Будем говорить, что внутренняя часть $\mathrm{In}$ разделяет внешнюю часть $\mathrm{Out}$, если у неё существуют две точки подключения, которые находятся по разные стороны цикла $C$, где стороны берутся относительно точек подключения $\mathrm{Out}$ (см. картинку).
        \end{definition}
        \begin{example}
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Arc [id:dp24254826825833287] 
                    \draw  [draw opacity=0] (358.11,88.34) .. controls (364.18,102.26) and (367.55,117.62) .. (367.55,133.77) .. controls (367.55,170.41) and (350.23,203) .. (323.34,223.81) -- (253.77,133.77) -- cycle ; \draw  [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,draw opacity=1 ] (358.11,88.34) .. controls (364.18,102.26) and (367.55,117.62) .. (367.55,133.77) .. controls (367.55,170.41) and (350.23,203) .. (323.34,223.81) ;  
                    %Shape: Arc [id:dp7438062927546976] 
                    \draw  [draw opacity=0] (321.5,225.2) .. controls (302.58,239.24) and (279.14,247.55) .. (253.77,247.55) .. controls (190.94,247.55) and (140,196.61) .. (140,133.77) .. controls (140,70.94) and (190.94,20) .. (253.77,20) .. controls (300.19,20) and (340.11,47.8) .. (357.81,87.65) -- (253.77,133.77) -- cycle ; \draw  [color={rgb, 255:red, 0; green, 0; blue, 255 }  ,draw opacity=1 ] (321.5,225.2) .. controls (302.58,239.24) and (279.14,247.55) .. (253.77,247.55) .. controls (190.94,247.55) and (140,196.61) .. (140,133.77) .. controls (140,70.94) and (190.94,20) .. (253.77,20) .. controls (300.19,20) and (340.11,47.8) .. (357.81,87.65) ;  
                    %Straight Lines [id:da48616162308916566] 
                    \draw    (321.4,225.26) -- (463.06,142.66) ;
                    %Straight Lines [id:da09816083328065961] 
                    \draw    (357.8,88.2) -- (461.64,94.6) ;
                    %Straight Lines [id:da3246672730852964] 
                    \draw    (329.6,49) -- (291.24,115.16) ;
                    %Straight Lines [id:da3647321560487098] 
                    \draw    (361.4,171.4) -- (291.24,157.56) ;
                    %Straight Lines [id:da21362559206306475] 
                    \draw    (149.6,179.4) -- (221.64,141.96) ;
                    %Shape: Ellipse [id:dp6351442582714808] 
                    \draw   (221,136.5) .. controls (221,120.76) and (239.76,108) .. (262.9,108) .. controls (286.04,108) and (304.8,120.76) .. (304.8,136.5) .. controls (304.8,152.24) and (286.04,165) .. (262.9,165) .. controls (239.76,165) and (221,152.24) .. (221,136.5) -- cycle ;
                    %Shape: Circle [id:dp06668840166642509] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (324.2,49) .. controls (324.2,46.02) and (326.62,43.6) .. (329.6,43.6) .. controls (332.58,43.6) and (335,46.02) .. (335,49) .. controls (335,51.98) and (332.58,54.4) .. (329.6,54.4) .. controls (326.62,54.4) and (324.2,51.98) .. (324.2,49) -- cycle ;
                    %Shape: Circle [id:dp08762646360449144] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (356,171.4) .. controls (356,168.42) and (358.42,166) .. (361.4,166) .. controls (364.38,166) and (366.8,168.42) .. (366.8,171.4) .. controls (366.8,174.38) and (364.38,176.8) .. (361.4,176.8) .. controls (358.42,176.8) and (356,174.38) .. (356,171.4) -- cycle ;
                    %Shape: Circle [id:dp9887746533272483] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (144.2,179.4) .. controls (144.2,176.42) and (146.62,174) .. (149.6,174) .. controls (152.58,174) and (155,176.42) .. (155,179.4) .. controls (155,182.38) and (152.58,184.8) .. (149.6,184.8) .. controls (146.62,184.8) and (144.2,182.38) .. (144.2,179.4) -- cycle ;
                    %Shape: Circle [id:dp8391128746432603] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (352.4,88.2) .. controls (352.4,85.22) and (354.82,82.8) .. (357.8,82.8) .. controls (360.78,82.8) and (363.2,85.22) .. (363.2,88.2) .. controls (363.2,91.18) and (360.78,93.6) .. (357.8,93.6) .. controls (354.82,93.6) and (352.4,91.18) .. (352.4,88.2) -- cycle ;
                    %Shape: Ellipse [id:dp16105115201202969] 
                    \draw   (457,117.1) .. controls (457,92.41) and (473.53,72.4) .. (493.92,72.4) .. controls (514.31,72.4) and (530.84,92.41) .. (530.84,117.1) .. controls (530.84,141.79) and (514.31,161.8) .. (493.92,161.8) .. controls (473.53,161.8) and (457,141.79) .. (457,117.1) -- cycle ;
                    %Shape: Circle [id:dp12165989427014212] 
                    \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (316,225.26) .. controls (316,222.27) and (318.42,219.86) .. (321.4,219.86) .. controls (324.38,219.86) and (326.8,222.27) .. (326.8,225.26) .. controls (326.8,228.24) and (324.38,230.66) .. (321.4,230.66) .. controls (318.42,230.66) and (316,228.24) .. (316,225.26) -- cycle ;
                    
                    % Text Node
                    \draw (262.9,136.5) node    {$\mathrm{In}$};
                    % Text Node
                    \draw (493.92,117.1) node    {$\mathrm{Out}$};
                    % Text Node
                    \draw (147.6,182.8) node [anchor=north east] [inner sep=0.75pt]    {$c$};
                    % Text Node
                    \draw (331.6,45.6) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (363.4,174.8) node [anchor=north west][inner sep=0.75pt]    {$b$};
                \end{tikzpicture}
            \end{figure}\noindent
            Тут у нас $\mathrm{In}$ разделяет $\mathrm{Out}$, потому что $\mathrm{Out}$ делит $C$ на красную и синюю часть. Если были бы только рёбра в $a$ и $c$, то не разделяла бы, а так разделяет, хотя хватило бы и пары рёбер в $a$ и в $b$ или в $b$ и в $c$.
        \end{example}
        \begin{remark}
            При этом считается, что если точка соединения внутренней и внешней части одна и та же, то это не разделение. Аналогично с разделением $u$ и $v$.
        \end{remark}
        \begin{lemma}
            Существует внутренняя часть $\mathrm{In}_0$ и внешняя часть $\mathrm{Out}_0$ такие что $\mathrm{In}_0$ разделяет $u$ и $v$ и $\mathrm{Out}_0$.
        \end{lemma}
        \begin{proof}
            Пусть это не так. Тогда рассмотрим любую внутреннюю часть. Она не разделяет ни одну внешнюю, а значит её точки соединения лежат строго между какими-то точками соединения разных внешних частей, а это значит, что её можно превратить во внешнюю, вынеся наружу. После проведения такой операции у нас не останется компонент, разделяющий $u$ и $v$, а значит мы сможем провести ребро между ними. Противоречие.
        \end{proof}
        Пусть наша компонента $\mathrm{Out}_0$ подключается в точках $a$ и $b$. А у того, как подключается $\mathrm{In}_0$, есть варианты. А точнее, получается 12 случаев. Мы рассмотрим два из них, потому что нам лень рассматривать все. Первый:
        \begin{figure}[H]
            \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                %Straight Lines [id:da40674906584093495] 
                \draw    (350.73,192.73) -- (289.3,172) ;
                %Straight Lines [id:da0045665072056451095] 
                \draw    (228.7,146.65) -- (175.4,52.2) ;
                %Straight Lines [id:da05979547244610006] 
                \draw    (338.73,57.53) -- (462.7,93.15) ;
                %Straight Lines [id:da10700468280984254] 
                \draw    (325.73,222.2) -- (484.2,160.65) ;
                %Straight Lines [id:da7719164346025176] 
                \draw  [dash pattern={on 4.5pt off 4.5pt}]  (142.77,107.67) -- (367.49,133.77) ;
                %Shape: Ellipse [id:dp6351442582714808] 
                \draw   (205.5,172) .. controls (205.5,156.26) and (224.26,143.5) .. (247.4,143.5) .. controls (270.54,143.5) and (289.3,156.26) .. (289.3,172) .. controls (289.3,187.74) and (270.54,200.5) .. (247.4,200.5) .. controls (224.26,200.5) and (205.5,187.74) .. (205.5,172) -- cycle ;
                %Shape: Ellipse [id:dp16105115201202969] 
                \draw   (457,117.1) .. controls (457,92.41) and (473.53,72.4) .. (493.92,72.4) .. controls (514.31,72.4) and (530.84,92.41) .. (530.84,117.1) .. controls (530.84,141.79) and (514.31,161.8) .. (493.92,161.8) .. controls (473.53,161.8) and (457,141.79) .. (457,117.1) -- cycle ;
                %Shape: Circle [id:dp4843311991817585] 
                \draw   (140.06,133.77) .. controls (140.06,70.97) and (190.97,20.06) .. (253.77,20.06) .. controls (316.58,20.06) and (367.49,70.97) .. (367.49,133.77) .. controls (367.49,196.58) and (316.58,247.49) .. (253.77,247.49) .. controls (190.97,247.49) and (140.06,196.58) .. (140.06,133.77) -- cycle ;
                %Shape: Circle [id:dp9950697085260289] 
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (362.09,133.77) .. controls (362.09,130.79) and (364.5,128.37) .. (367.49,128.37) .. controls (370.47,128.37) and (372.89,130.79) .. (372.89,133.77) .. controls (372.89,136.76) and (370.47,139.17) .. (367.49,139.17) .. controls (364.5,139.17) and (362.09,136.76) .. (362.09,133.77) -- cycle ;
                %Shape: Circle [id:dp23061305390954878] 
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (137.37,107.67) .. controls (137.37,104.68) and (139.78,102.27) .. (142.77,102.27) .. controls (145.75,102.27) and (148.17,104.68) .. (148.17,107.67) .. controls (148.17,110.65) and (145.75,113.07) .. (142.77,113.07) .. controls (139.78,113.07) and (137.37,110.65) .. (137.37,107.67) -- cycle ;
                %Shape: Circle [id:dp6618290772718289] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (345.33,192.73) .. controls (345.33,189.75) and (347.75,187.33) .. (350.73,187.33) .. controls (353.72,187.33) and (356.13,189.75) .. (356.13,192.73) .. controls (356.13,195.72) and (353.72,198.13) .. (350.73,198.13) .. controls (347.75,198.13) and (345.33,195.72) .. (345.33,192.73) -- cycle ;
                %Shape: Circle [id:dp531319718425953] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (333.33,57.53) .. controls (333.33,54.55) and (335.75,52.13) .. (338.73,52.13) .. controls (341.72,52.13) and (344.13,54.55) .. (344.13,57.53) .. controls (344.13,60.52) and (341.72,62.93) .. (338.73,62.93) .. controls (335.75,62.93) and (333.33,60.52) .. (333.33,57.53) -- cycle ;
                %Shape: Circle [id:dp3989240968914449] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (320.33,222.2) .. controls (320.33,219.22) and (322.75,216.8) .. (325.73,216.8) .. controls (328.72,216.8) and (331.13,219.22) .. (331.13,222.2) .. controls (331.13,225.18) and (328.72,227.6) .. (325.73,227.6) .. controls (322.75,227.6) and (320.33,225.18) .. (320.33,222.2) -- cycle ;
                %Shape: Circle [id:dp9668933955857892] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (170,52.2) .. controls (170,49.22) and (172.42,46.8) .. (175.4,46.8) .. controls (178.38,46.8) and (180.8,49.22) .. (180.8,52.2) .. controls (180.8,55.18) and (178.38,57.6) .. (175.4,57.6) .. controls (172.42,57.6) and (170,55.18) .. (170,52.2) -- cycle ;

                % Text Node
                \draw (247.4,172) node    {$\mathrm{In}_{0}$};
                % Text Node
                \draw (493.92,117.1) node    {$\mathrm{Out}_{0}$};
                % Text Node
                \draw (140.77,104.27) node [anchor=south east] [inner sep=0.75pt]    {$u$};
                % Text Node
                \draw (369.49,130.37) node [anchor=south west] [inner sep=0.75pt]    {$v$};
                % Text Node
                \draw (340.73,54.13) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                % Text Node
                \draw (327.73,225.6) node [anchor=north west][inner sep=0.75pt]    {$b$};
                % Text Node
                \draw (173.4,48.8) node [anchor=south east] [inner sep=0.75pt]    {$x$};
                % Text Node
                \draw (348.73,189.33) node [anchor=south east] [inner sep=0.75pt]    {$y$};
            \end{tikzpicture}
        \end{figure}\noindent
        Ну, тут $K_{3,3}$ налицо. Первая доля состоит из вершин $v$, $b$ и $x$, вторая~--- из $u$, $a$ и $y$.\\
        И на самом деле почти во всех случаях мы будем находить $K_{3,3}$ и только в одном найдём $K_5$. случай там такой:
        \begin{figure}[H]
            \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                %Straight Lines [id:da9587546719834164] 
                \draw    (142.77,107.67) -- (213.7,154.45) ;
                %Straight Lines [id:da6263691313944992] 
                \draw    (367.49,133.77) -- (289.3,172) ;
                %Straight Lines [id:da5165707185850743] 
                \draw    (338.73,57.53) -- (273.2,148.95) ;
                %Straight Lines [id:da8842732332896879] 
                \draw    (281.2,188.45) -- (325.73,222.2) ;
                %Straight Lines [id:da05979547244610006] 
                \draw    (338.73,57.53) -- (462.7,93.15) ;
                %Straight Lines [id:da10700468280984254] 
                \draw    (325.73,222.2) -- (484.2,160.65) ;
                %Straight Lines [id:da7719164346025176] 
                \draw  [dash pattern={on 4.5pt off 4.5pt}]  (142.77,107.67) -- (367.49,133.77) ;
                %Shape: Ellipse [id:dp6351442582714808] 
                \draw   (205.5,172) .. controls (205.5,156.26) and (224.26,143.5) .. (247.4,143.5) .. controls (270.54,143.5) and (289.3,156.26) .. (289.3,172) .. controls (289.3,187.74) and (270.54,200.5) .. (247.4,200.5) .. controls (224.26,200.5) and (205.5,187.74) .. (205.5,172) -- cycle ;
                %Shape: Ellipse [id:dp16105115201202969] 
                \draw   (457,117.1) .. controls (457,92.41) and (473.53,72.4) .. (493.92,72.4) .. controls (514.31,72.4) and (530.84,92.41) .. (530.84,117.1) .. controls (530.84,141.79) and (514.31,161.8) .. (493.92,161.8) .. controls (473.53,161.8) and (457,141.79) .. (457,117.1) -- cycle ;
                %Shape: Circle [id:dp4843311991817585] 
                \draw   (140.06,133.77) .. controls (140.06,70.97) and (190.97,20.06) .. (253.77,20.06) .. controls (316.58,20.06) and (367.49,70.97) .. (367.49,133.77) .. controls (367.49,196.58) and (316.58,247.49) .. (253.77,247.49) .. controls (190.97,247.49) and (140.06,196.58) .. (140.06,133.77) -- cycle ;
                %Shape: Circle [id:dp9950697085260289] 
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (362.09,133.77) .. controls (362.09,130.79) and (364.5,128.37) .. (367.49,128.37) .. controls (370.47,128.37) and (372.89,130.79) .. (372.89,133.77) .. controls (372.89,136.76) and (370.47,139.17) .. (367.49,139.17) .. controls (364.5,139.17) and (362.09,136.76) .. (362.09,133.77) -- cycle ;
                %Shape: Circle [id:dp23061305390954878] 
                \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (137.37,107.67) .. controls (137.37,104.68) and (139.78,102.27) .. (142.77,102.27) .. controls (145.75,102.27) and (148.17,104.68) .. (148.17,107.67) .. controls (148.17,110.65) and (145.75,113.07) .. (142.77,113.07) .. controls (139.78,113.07) and (137.37,110.65) .. (137.37,107.67) -- cycle ;
                %Shape: Circle [id:dp531319718425953] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (333.33,57.53) .. controls (333.33,54.55) and (335.75,52.13) .. (338.73,52.13) .. controls (341.72,52.13) and (344.13,54.55) .. (344.13,57.53) .. controls (344.13,60.52) and (341.72,62.93) .. (338.73,62.93) .. controls (335.75,62.93) and (333.33,60.52) .. (333.33,57.53) -- cycle ;
                %Shape: Circle [id:dp3989240968914449] 
                \draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (320.33,222.2) .. controls (320.33,219.22) and (322.75,216.8) .. (325.73,216.8) .. controls (328.72,216.8) and (331.13,219.22) .. (331.13,222.2) .. controls (331.13,225.18) and (328.72,227.6) .. (325.73,227.6) .. controls (322.75,227.6) and (320.33,225.18) .. (320.33,222.2) -- cycle ;

                % Text Node
                \draw (247.4,172) node    {$\mathrm{In}_{0}$};
                % Text Node
                \draw (493.92,117.1) node    {$\mathrm{Out}_{0}$};
                % Text Node
                \draw (140.77,104.27) node [anchor=south east] [inner sep=0.75pt]    {$u$};
                % Text Node
                \draw (369.49,130.37) node [anchor=south west] [inner sep=0.75pt]    {$v$};
                % Text Node
                \draw (340.73,54.13) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                % Text Node
                \draw (327.73,225.6) node [anchor=north west][inner sep=0.75pt]    {$b$};
            \end{tikzpicture}
        \end{figure}\noindent
        Причём на самом деле $K_5$ мы найдём не совсем в таком случае. Случай с картинки делится ещё на 2 под-случая: когда внутри $\mathrm{In_0}$ есть вершина, соединённая с $a$, $b$, $u$ и $v$ непересекающимися путями, и когда такой нет. И вот когда такая есть, только тогда мы найдём $K_5$ (собственно, из этой вершины и $a$, $b$, $u$ и $v$). Если нет, там будет $K_{3,3}$.
    \end{proof}
    \paragraph{Раскраски графа.}
    \begin{definition}
        Пусть дан $G$~--- неориентированный граф и отображение $c\colon V\to[1:k]$. При этом выполнено условие $\forall uv\in E~c(u)\neq c(v)$. Тогда $c$ называется \textbf{(корректной) раскраской} графа $G$ в $k$ цветов.
    \end{definition}
    \begin{definition}
        \textbf{$k$-раскрашиваемый граф}~--- граф, который можно покрасить в $k$ цветов. Также он называется \textbf{$k$-дольным}.
    \end{definition}
    \begin{claim}
        В планарном графе существует вершина степени $\leqslant 5$.
    \end{claim}
    \begin{proof}
        Следует из $E\leqslant 3V-6$.
    \end{proof}
    \begin{theorem}
        Любой планарный граф можно раскрасить в 6 цветов.
    \end{theorem}
    \begin{proof}
        Индукция по числу вершин. База ясно, в переходе удалим вершину степени $\leqslant 5$, покрасим, вернём, останется лишний цвет.
    \end{proof}
    \begin{theorem}[Теорема Хивуда]
        Любой планарный граф можно раскрасить в 5 цветов.
    \end{theorem}
    \begin{proof}
        Рассмотрим вершину $u~\deg u\leqslant5$. Если $\deg u<5$, мы см. предыдущую теорему. Если среди соседей вершины $u$ есть не все цвета~--- тоже. А что есть есть все? Давайте пронумеруем соседей $u$ по часовой стрелке и перенумеруем цвета в соответствии с этим порядком. Связаны ли 1 и 3 вершина? Если нет, то возьмём все вершины цветов 1 и 3 (связанные с нашей вершиной цвета 3) перекрасим в противоположный цвет. Если же 1 и 3 связаны, то рассмотрим 2 и 4, и сделаем с ними то же самое. 2 и 4 связаны точно быть не могут, им мешает планарность и путь из 1 в 3.
    \end{proof}
    \begin{theorem}
        Любой планарный граф можно раскрасить в 4 цвета.
    \end{theorem}
    \begin{remark}
        К чему нам нужна раскраска графов? Это напрямую связано с раскрасками карт. Пусть у нас есть какие-то средневековые княжества, никакие 4 границы в одной точке не сходятся, нет анклавов и прочих приколов. И это сейчас у нас куча цветов, а в средние века краски были дороги. И хочется использовать минимум красок.\\
        Понятно, что в 3 нельзя (рассмотрите $K_4$). И во времена Эйлера была сформулирована гипотеза о 4 красках, что всегда можно в 4 цвета. Никто не мог ни доказать, ни опровергнуть. Где-то в середине 20 века был получен следующий результат: существует конечное множество графов, что если каждый из них красится в 4 цвета, то любой граф точно красится. И были оценки на размер этого множества. Дальше во второй половине XX века людям пришла в голову идея построить это множество и перебрать все. В 1976 Аппель и Хакен написали программу, получили 1936 графов, каждый из которых раскрасили. Но научное сообщество знатно охренело, и разгорелся спор о том, насколько это легально вообще. Но в 2005 доказательство было представлено на Coq, и после этого все согласились.
    \end{remark}
    \begin{remark}
        Остаётся лишь сделать алгоритм проверки графа на то, красится ли он в 3 цвета. Но, увы, даже для планарных графов задача NP-полна.
    \end{remark}
    \begin{definition}
        $p_G(t)$~--- количество способов покрасить граф $G$ в $t$ цветов~--- \textbf{хроматический полином}.
    \end{definition}
    \begin{example}
        \begin{itemize}
            \item $p_{\overline{K_n}}(t)=t^n$.
            \item $p_{K_n}(t)=t(t-1)(t-2)\cdots(t-n+1)=t^{\underline n}$.
            \item Пусть $T$~--- дерево. Подвесим дерево, первую вершину красим в $t$, остальные в $t-1$ цвет: $p_T(t)=t(t-1)^{n-1}$.
        \end{itemize}
    \end{example}
    \begin{theorem}
        Пусть $uv\in EG$. Тогда $p_G(t)=p_{G\setminus uv}(t)-p_{G/uv}(t)$.
    \end{theorem}
    \begin{proof}
        Самое сложное здесь~--- понять, что такое $G/uv$. А это когда вы берёте граф и объединяете $u$ и $v$ в одну вершину, к которой теперь идут все рёбра, инцидентные $u$ или $v$.\\
        Дальше доказать это очень просто: берём раскраску $G\setminus uv$. Она нам либо подходит, либо нет. Когда нет? Когда $u$ и $v$ покрашены в один цвет. Ну так это корректная раскраска $G/uv$. Все такие раскраски вычтем, получим что хотим.
    \end{proof}
    \begin{theorem}
        $p_G(t)$~--- многочлен по $t$. При этом:
        $$
        p_G(t)=t^n-mt^{n-1}+a_{n-2}t^{n-2}-a_{n-3}t^{n-3}+\cdots\pm a_kt^k
        $$
        где $k$~--- количество компонент связности.
    \end{theorem}
    \begin{proof}
        Будем вести индукцию по чисту вершин и рёбер. В $G\setminus uv$ на одно ребро меньше, в $G/uv$ на одну вершину. Если вычесть, мы сразу получим всё, что хотим, кроме компонент связности (а именно степень многочлена, коэффициент при $t^{n-1}$ и знакочередование). Теперь вопрос в компонентах связности. Если мы сожмём, количество компонент связности не изменится. Если мы уберём ребро, количество компонент связности либо увеличится, либо не изменится. Итого у нас $a_k$ будет либо как в $G/uv$, либо больше.
    \end{proof}
    \begin{corollary}
        $G$ дерево тогда и только тогда, когда $p_G(t)=t(t-1)^{n-1}$.
    \end{corollary}
    \begin{definition}
        Минимальное число цветов, в которое можно покрасить граф $G$ называется \textbf{хроматическим числом} и обозначается $\chi_G$.
    \end{definition}
    \begin{lemma}
        Пусть $G$~--- не регулярный граф. Тогда $\chi(G)\leqslant\Delta(G)$.
    \end{lemma}
    \begin{proof}
        Рассмотрим вершину не максимальной степени $u$. Если граф не связен, рассмотрим каждую компоненту отдельно. Занумеруем вершины графа в порядке убывания расстояния до $u$. Выполним жадную раскраску в этом порядке. У нас на каждом этапе, кроме последнего, будет хотя бы один непокрашенный сосед, а значит в $\Delta$ цветов можно покрасить. А на последнем этапе мы посмотрим на $u$, у неё степень меньше $\Delta$, значит тоже можно покрасить.
    \end{proof}
    \begin{definition}
        $\kappa(G)$~--- минимальное число вершин, которое можно удалить, чтобы $G$ потеряет связность.
    \end{definition}
    \begin{theorem}[Теорема Брукса]
        Если $G$~--- не $K_m$ и не цикл нечётной длины, то $\chi_G\leqslant\Delta(G)$.
    \end{theorem}
    \begin{proof}
        Рассмотрим несколько случаев.
        \begin{enumerate}
            \item Пусть $\kappa(G)=1$. Тогда у нас есть точка сочленения, расчленим её, покрасим две полученные компоненты связности по лемме (степень точки сочленения изменилась, значит граф перестал быть регулярным), объединив обратно, попутно перенумеровав цвета в одной из компонент.
            \item Пусть $\kappa(G)=2$. Тогда у нас есть две вершины, которые мы удаляем ($a$ и $b$). Если они соединены ребром, сделаем то же самое, что в случае раньше. Если они не соединены ребром, то у нас могут быть проблемы с тем, что у нас в одной раскраске они одного цвета, а в другой~--- разного. Тогда мы очень хотим добавить ребро $ab$ во все компоненты связности.
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Circle [id:dp3541434208719394] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (255.2,160) .. controls (255.2,157.02) and (257.62,154.6) .. (260.6,154.6) .. controls (263.58,154.6) and (266,157.02) .. (266,160) .. controls (266,162.98) and (263.58,165.4) .. (260.6,165.4) .. controls (257.62,165.4) and (255.2,162.98) .. (255.2,160) -- cycle ;
                    %Shape: Circle [id:dp24647657401289957] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (271.2,49) .. controls (271.2,46.02) and (273.62,43.6) .. (276.6,43.6) .. controls (279.58,43.6) and (282,46.02) .. (282,49) .. controls (282,51.98) and (279.58,54.4) .. (276.6,54.4) .. controls (273.62,54.4) and (271.2,51.98) .. (271.2,49) -- cycle ;
                    %Shape: Circle [id:dp5579177771154191] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (314.2,153) .. controls (314.2,150.02) and (316.62,147.6) .. (319.6,147.6) .. controls (322.58,147.6) and (325,150.02) .. (325,153) .. controls (325,155.98) and (322.58,158.4) .. (319.6,158.4) .. controls (316.62,158.4) and (314.2,155.98) .. (314.2,153) -- cycle ;
                    %Shape: Circle [id:dp5724108870938078] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (314.2,273) .. controls (314.2,270.02) and (316.62,267.6) .. (319.6,267.6) .. controls (322.58,267.6) and (325,270.02) .. (325,273) .. controls (325,275.98) and (322.58,278.4) .. (319.6,278.4) .. controls (316.62,278.4) and (314.2,275.98) .. (314.2,273) -- cycle ;
                    %Shape: Circle [id:dp11245740917295022] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (366.2,46) .. controls (366.2,43.02) and (368.62,40.6) .. (371.6,40.6) .. controls (374.58,40.6) and (377,43.02) .. (377,46) .. controls (377,48.98) and (374.58,51.4) .. (371.6,51.4) .. controls (368.62,51.4) and (366.2,48.98) .. (366.2,46) -- cycle ;
                    %Shape: Circle [id:dp9740639314828261] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (402.2,159) .. controls (402.2,156.02) and (404.62,153.6) .. (407.6,153.6) .. controls (410.58,153.6) and (413,156.02) .. (413,159) .. controls (413,161.98) and (410.58,164.4) .. (407.6,164.4) .. controls (404.62,164.4) and (402.2,161.98) .. (402.2,159) -- cycle ;
                    %Curve Lines [id:da004565346887659416] 
                    \draw    (276.6,49) .. controls (159.8,-11) and (166.8,246) .. (260.6,160) ;
                    %Curve Lines [id:da028209260811515646] 
                    \draw    (319.6,153) .. controls (285.8,177) and (296.8,255) .. (319.6,273) ;
                    %Curve Lines [id:da5115797200976935] 
                    \draw    (407.6,159) .. controls (477.8,198) and (523.8,-11) .. (371.6,46) ;
                    %Curve Lines [id:da03568350921924668] 
                    \draw    (319.6,153) .. controls (339.8,182) and (340.8,220) .. (319.6,273) ;
                    %Straight Lines [id:da04311744716768606] 
                    \draw  [dash pattern={on 4.5pt off 4.5pt}]  (276.6,49) -- (260.6,160) ;
                    %Straight Lines [id:da8573268847719253] 
                    \draw  [dash pattern={on 4.5pt off 4.5pt}]  (371.6,46) -- (407.6,159) ;
                    %Curve Lines [id:da015268853778678482] 
                    \draw  [dash pattern={on 4.5pt off 4.5pt}]  (319.6,153) .. controls (382.8,143) and (378.8,280) .. (319.6,273) ;

                    % Text Node
                    \draw (278.6,45.6) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (321.6,149.6) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (369.6,42.6) node [anchor=south east] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (262.6,163.4) node [anchor=north west][inner sep=0.75pt]    {$b$};
                    % Text Node
                    \draw (317.6,276.4) node [anchor=north east] [inner sep=0.75pt]    {$b$};
                    % Text Node
                    \draw (405.6,162.4) node [anchor=north east] [inner sep=0.75pt]    {$b$};
                \end{tikzpicture}
            \end{figure}\noindent
            Мы не можем его добавить только если какая-то компонента связности станет регулярной. То есть в одной из них степень всех вершин, кроме $a$ и $b$ равна $\Delta$, а у $a$ и $b$~--- $\Delta-1$. Тогда компонент всего две и во второй у $a$ и $b$ степень 1. 
            \begin{figure}[H]
                \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                    %Shape: Circle [id:dp3541434208719394] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (255.2,198) .. controls (255.2,195.02) and (257.62,192.6) .. (260.6,192.6) .. controls (263.58,192.6) and (266,195.02) .. (266,198) .. controls (266,200.98) and (263.58,203.4) .. (260.6,203.4) .. controls (257.62,203.4) and (255.2,200.98) .. (255.2,198) -- cycle ;
                    %Shape: Circle [id:dp24647657401289957] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (271.2,87) .. controls (271.2,84.02) and (273.62,81.6) .. (276.6,81.6) .. controls (279.58,81.6) and (282,84.02) .. (282,87) .. controls (282,89.98) and (279.58,92.4) .. (276.6,92.4) .. controls (273.62,92.4) and (271.2,89.98) .. (271.2,87) -- cycle ;
                    %Shape: Circle [id:dp11245740917295022] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (366.2,84) .. controls (366.2,81.02) and (368.62,78.6) .. (371.6,78.6) .. controls (374.58,78.6) and (377,81.02) .. (377,84) .. controls (377,86.98) and (374.58,89.4) .. (371.6,89.4) .. controls (368.62,89.4) and (366.2,86.98) .. (366.2,84) -- cycle ;
                    %Shape: Circle [id:dp9740639314828261] 
                    \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (402.2,197) .. controls (402.2,194.02) and (404.62,191.6) .. (407.6,191.6) .. controls (410.58,191.6) and (413,194.02) .. (413,197) .. controls (413,199.98) and (410.58,202.4) .. (407.6,202.4) .. controls (404.62,202.4) and (402.2,199.98) .. (402.2,197) -- cycle ;
                    %Curve Lines [id:da004565346887659416] 
                    \draw    (276.6,87) .. controls (159.8,27) and (166.8,284) .. (260.6,198) ;
                    %Curve Lines [id:da5115797200976935] 
                    \draw    (407.6,197) .. controls (477.8,236) and (523.8,27) .. (371.6,84) ;
                    %Straight Lines [id:da04311744716768606] 
                    \draw  [dash pattern={on 4.5pt off 4.5pt}]  (276.6,87) -- (260.6,198) ;
                    %Straight Lines [id:da8573268847719253] 
                    \draw  [dash pattern={on 4.5pt off 4.5pt}]  (371.6,84) -- (407.6,197) ;
                    %Straight Lines [id:da6813613294674061] 
                    \draw    (371.6,84) -- (412.8,84) ;
                    %Straight Lines [id:da3403649484299003] 
                    \draw    (371.6,84) -- (413.8,93) ;
                    %Straight Lines [id:da32893816103547535] 
                    \draw    (371.6,84) -- (408.8,103) ;
                    %Straight Lines [id:da6741996837870379] 
                    \draw    (407.6,197) -- (443.8,187) ;
                    %Straight Lines [id:da7842358279736754] 
                    \draw    (407.6,197) -- (435.8,176) ;
                    %Straight Lines [id:da680686092703501] 
                    \draw    (407.6,197) -- (425.8,169) ;
                    %Straight Lines [id:da5838664251320986] 
                    \draw    (220.8,109) -- (276.6,87) ;
                    %Straight Lines [id:da7761134022447498] 
                    \draw    (213.8,168) -- (260.6,198) ;

                    % Text Node
                    \draw (278.6,83.6) node [anchor=south west] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (369.6,80.6) node [anchor=south east] [inner sep=0.75pt]    {$a$};
                    % Text Node
                    \draw (262.6,201.4) node [anchor=north west][inner sep=0.75pt]    {$b$};
                    % Text Node
                    \draw (405.6,200.4) node [anchor=north east] [inner sep=0.75pt]    {$b$};
                \end{tikzpicture}
            \end{figure}\noindent
            И тогда если у них общий сосед, можно покрасить их хоть в разные цвета, хоть в 1 (тут мы используем то, что $\Delta>2$). А если разные соседи, то можно заменить $b$ на её соседа, они тоже будут разделять вершины, и это предыдущий случай.
            \item Пусть $\kappa(G)>2$. То есть удаление никаких двух вершин не разделяет граф. Рассмотрим вершину $x$. Какие-то два её соседа не соединены ребром (по неполноте $G$). Назовём их $a$ и $b$. Упорядочим вершины по убыванию расстояния от $x$ в графе $G\setminus\{a,b\}$ (он связен из-за $\kappa(G)>2$). Раскрасим $a$ и $b$ в первый цвет, а дальше используем жадную раскраску. У нас не будет проблем ни с $x$ (у неё два соседа одного цвета), ни с остальными вершинами.
        \end{enumerate}
    \end{proof}
    \begin{definition}
        \textbf{Инвариантом} графа называется некоторая его характеристика, не меняющееся при изоморфизме.
    \end{definition}
    \begin{remark}
        И тут уже есть вопросы: можно ли проверять изоморфность быстро? С одной стороны, мы не умеем делать это полиномиально, но и доказывать NP-полноту также не умеем (более того, предположив её NP-полноту, получим очень сомнительные (но не факт, что неверные) следствия).
    \end{remark}
    \paragraph{Паросочетания.}
    \begin{definition}
        \textbf{Паросочетанием} в графе называется множество рёбер, такое что никакие два не имеют общую вершину. \textbf{Размером паросочетания} называется количество его рёбер. Размер максимального паросочетания обозначается $\alpha'(G)$.
    \end{definition}
    \begin{definition}
        \textbf{Независимым множеством} или \textbf{антикликой} в графе называется множество вершин, такое что никакие две не соединены ребром. Размер максимальной антиклики обозначается $\alpha(G)$.
    \end{definition}
    \begin{definition}
        \textbf{Вершинным покрытием} графа называется множество вершин, такое что хотя бы один из концов любого ребра лежит в нём. Размер минимального вершинного покрытия обозначается $\beta(G)$.
    \end{definition}
    \begin{definition}
        \textbf{Рёберным покрытием} графа называется множество рёбер, такое что каждая вершина инцидентна хотя бы одному ребру. Размер минимального вершинного покрытия обозначается $\beta'(G)$.
    \end{definition}
    \begin{definition}
        \textbf{Вершинным доминирующим множеством} графа называется такое множество вершин, что любая вершина либо лежит в нём, либо имеет соседа в этом множестве. Размер минимального вершинного доминирующего множества обозначается $\gamma(G)$.
    \end{definition}
    \begin{definition}
        \textbf{Рёберным доминирующим множеством} графа называется такое множество рёбер, что любое ребро либо лежит в нём, имеет общую вершину с каким-то ребром множества. Размер минимального рёберного доминирующего множества обозначается $\gamma'(G)$.
    \end{definition}
    \begin{claim}
        $\alpha(G)+\beta(G)=n$
    \end{claim}
    \begin{proof}
        Очевидно, если $A$~--- независимое множество, то $V\setminus A$~--- вершинное покрытие.
    \end{proof}
    \begin{definition}
        Вершина называется \textbf{покрытой} паросочетанием, если в паросочетании есть ребро с концом в ней. Иначе вершина называется \textbf{свободной}.
    \end{definition}
    \begin{definition}
        Паросочетание называется \textbf{совершенным} или \textbf{полным}, если оно покрывает все вершины.
    \end{definition}
    \begin{remark}
        Чтобы в графе существовало совершенное паросочетание необходимо, чтобы количество вершин было чётно. Но, разумеется, не достаточно.
    \end{remark}
    \begin{theorem}[Критерий Татта]
        Граф $G$ содержит совершенное паросочетание тогда и только тогда, когда $\forall A\subset V~|A|\geqslant$ количество нечётных компонент связности $G\setminus A$. Далее количество нечётных компонент называется $\operatorname{odd}$.
    \end{theorem}
    \begin{remark}
        Практического применения у этой теоремы маловато будет в силу количества подмножеств.
    \end{remark}
    \begin{remark}
        Перед доказательством обсудим, как выглядит $\mathrm{xor}$ двух паросочетаний. Это граф, в котором степень каждой вершины не больше двух. Ноль~--- когда вершина не была ни в одном, либо в обоих имело одно ребро в паросочетании. Один~--- когда вершина была только в одном паросочетании. Два~--- когда имела два разных ребра в разных паросочетаниях.\\
        При этом если оба паросочетания были полны, у нас убирается вариант 1. И получается, что граф состоит из циклов и изолированных вершин.
    \end{remark}
    \begin{proof}
        Когда мы удалим $A$ у нас какие-то пары останутся, какие-то удалятся, а у каких-то мы отрежем одну вершину из паросочетания. А значит нечётные компоненты связности должны были соединяться с $A$. Причём все с различными вершинами. Это доказательство право.\\
        Теперь влево. Предположим, что совершенного паросочетания нет, но условие выполнено (назовём условие $(*)$). Выберем из всех таких графов граф с минимальным числом вершин, а из всех с одинаковым количеством вершин~--- с максимальным числом рёбер. Заметим, что проведение нового ребра не нарушает $(*)$, а значит если $uv\notin E$, то $G\cup\{uv\}$ содержит совершенное паросочетание. Заметим, что $G$ не полон (в силу $(*)$ и отсутствия паросочетания). А значит существует ребро $uv\notin E$.\\
        Выберем $U$~--- множество вершин степени $n-1$.
        \begin{lemma}
            Все компоненты связности $G\setminus U$~--- полный граф.
        \end{lemma}
        \begin{proof}
            Предположим, что это не так. Значит в $G\setminus U$ есть компонента~--- не полный граф. Там хотя бы 3 вершины. Из одного из случаев теоремы Брукса в неполном графе есть вершина $x$ с двумя несоединёнными соседями: $y$ и $z$. При этом $x\notin U$, а значит $x$ не соединена с какой-то вершиной $w$. При этом если мы добавим $yz$, то граф будет содержать совершенное паросочетание ($M_1$). Аналогично, при добавлении $wz$ получается граф с совершенным паросочетанием $M_2$. Каждое из них содержит соответствующее ребро. Когда мы видим два паросочетания, хочется сделать им $\mathrm{xor}$. Паросочетания точно разные и оба совершенные, значит $M_1\oplus M_2$ содержит изолированные вершины и циклы. Дальше есть два варианта:
            \begin{enumerate}
                \item $xw$ и $yz$ лежат в разных циклах ($C_1$ и $C_2$ соотвественно). Тогда взяв $M_1\oplus C_2$, получим совершенное паросочетание исходного графа.
                \item Если $xw$ и $yz$ лежат в одном цикле
                \begin{figure}[H]
                    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
                        %Straight Lines [id:da3040812229473795] 
                        \draw [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ]   (300.4,76.4) -- (212.27,76.86) ;
                        %Straight Lines [id:da6176675048991476] 
                        \draw    (212.27,76.86) -- (129.27,98.86) ;
                        %Straight Lines [id:da18347097706894777] 
                        \draw [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,draw opacity=1 ]   (129.27,98.86) -- (104.27,162.86) ;
                        %Straight Lines [id:da01906400682029119] 
                        \draw    (104.27,162.86) -- (158.27,212.86) ;
                        %Straight Lines [id:da9996507180334211] 
                        \draw [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,draw opacity=1 ]   (158.27,212.86) -- (251.27,231.86) ;
                        %Straight Lines [id:da8521307160899989] 
                        \draw    (348.4,181.4) -- (251.27,231.86) ;
                        %Straight Lines [id:da7370743379833384] 
                        \draw [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,draw opacity=1 ]   (348.4,181.4) -- (458.27,172.86) ;
                        %Straight Lines [id:da9914311549915771] 
                        \draw    (458.27,172.86) -- (517.27,105.86) ;
                        %Straight Lines [id:da18152470235789897] 
                        \draw [color={rgb, 255:red, 255; green, 0; blue, 0 }  ,draw opacity=1 ]   (394.4,75.4) -- (517.27,105.86) ;
                        %Straight Lines [id:da3880169771138211] 
                        \draw    (300.4,76.4) -- (394.4,75.4) ;
                        %Straight Lines [id:da9229960732803515] 
                        \draw [color={rgb, 255:red, 74; green, 144; blue, 226 }  ,draw opacity=1 ]   (394.4,75.4) -- (348.4,181.4) ;
                        %Straight Lines [id:da6544702202498922] 
                        \draw [color={rgb, 255:red, 74; green, 144; blue, 226 }  ,draw opacity=1 ]   (300.4,76.4) -- (348.4,181.4) ;
                        %Shape: Circle [id:dp5181938127999859] 
                        \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (295,76.4) .. controls (295,73.42) and (297.42,71) .. (300.4,71) .. controls (303.38,71) and (305.8,73.42) .. (305.8,76.4) .. controls (305.8,79.38) and (303.38,81.8) .. (300.4,81.8) .. controls (297.42,81.8) and (295,79.38) .. (295,76.4) -- cycle ;
                        %Shape: Circle [id:dp7006669657752864] 
                        \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (389,75.4) .. controls (389,72.42) and (391.42,70) .. (394.4,70) .. controls (397.38,70) and (399.8,72.42) .. (399.8,75.4) .. controls (399.8,78.38) and (397.38,80.8) .. (394.4,80.8) .. controls (391.42,80.8) and (389,78.38) .. (389,75.4) -- cycle ;
                        %Shape: Circle [id:dp3414635961528829] 
                        \draw  [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ,fill opacity=1 ] (343,181.4) .. controls (343,178.42) and (345.42,176) .. (348.4,176) .. controls (351.38,176) and (353.8,178.42) .. (353.8,181.4) .. controls (353.8,184.38) and (351.38,186.8) .. (348.4,186.8) .. controls (345.42,186.8) and (343,184.38) .. (343,181.4) -- cycle ;

                        % Text Node
                        \draw (460.27,176.26) node [anchor=north west][inner sep=0.75pt]    {$w$};
                        % Text Node
                        \draw (350.4,184.8) node [anchor=north west][inner sep=0.75pt]    {$x$};
                        % Text Node
                        \draw (298.4,67.6) node [anchor=south east] [inner sep=0.75pt]    {$y$};
                        % Text Node
                        \draw (396.4,66.6) node [anchor=south west] [inner sep=0.75pt]    {$z$};
                    \end{tikzpicture}
                \end{figure}
                Тогда на правой половине этого цикла возьмём чёрные рёбра, в левой~--- красные. И ещё возьмём ребро $xz$. Ещё у нас может быть отражённая картинка, нам пришлось бы брать $yx$.
            \end{enumerate}
            В любом случае получаем противоречие.
        \end{proof}
        Когда у нас есть лемма, подставим $U$ в $(*)$. Тогда мы удалим $U$ и у нас останется набор полных графов. В полных чётного размера возьмём совершенное паросочетание, в нечётных~--- полное без одной вершины. По $(*)$ в $U$ хотя бы столько вершин, сколько надо, да ещё и каждая связана со всеми вершинами, а значит паросочетание можно дополнить до совершенного.
    \end{proof}
    \begin{definition}
        \textbf{Множеством Татта} называется $A\subset V~|A|<\operatorname{odd}(G\setminus A)$.
    \end{definition}
    \begin{remark}
        Множества Татта могут быть разными. Хочется узнать, влияет ли на что-то его <<таттовость>>.
    \end{remark}
    \begin{theorem}[Теорема Бержа]
        $n-2\alpha'(G)=\max\limits_{A\subset V}(\operatorname{odd}(G\setminus A)-|A|)$
    \end{theorem}
    \begin{proof}
        Если максимум равен нулю, см. теорему Татта. Иначе обозначит правую часть за $k$.\\
        Давайте рассмотрим $G+K_k$ (соединение всех вершин $G$ и $K_k$ <<каждая с каждой>>). Докажем, что для $G+K_k$ выполнен критерий Татта. Ну, возьмём $A\subset G+K_k$. Дальше случаи
        \begin{enumerate}
            \item $A$ пусто. Пусть исходно максимум достигался на каком-то множестве $S$. Пусть
            $$
            n'=n+\operatorname{odd}(G\setminus S)-|S|\overset{\small\operatorname{mod}2}\equiv n+\operatorname{odd}(G\setminus S)+|S|\overset{\small\operatorname{mod}2}\equiv\hspace{-4.75em}\sum\limits_{S_i\text{~--- компонента связности }G\setminus S}\hspace{-4.5em}(|S_i|\mathop\%2)+S\mathop\%2+\operatorname{odd}(G\setminus S)\mathop\%2+|S|\mathop\%2
            $$
            Это делится на 2.
            \item $K_k\not\subset A$. Тогда $G+K_k\setminus A$ связен. Если он чётен, мы победили, иначе, если в силу непустоты $A$~--- тоже.
            \item $K_k\subset A$. Тогда
            $$
            \operatorname{odd}(G+K_k\setminus A)=\operatorname{odd}(G\setminus(A\setminus K_k))\leqslant|A\setminus K_k|+k=|A|-k+k=|A|
            $$
        \end{enumerate}
        Действительно, выполнен. А значит в $G+K_k$ есть совершенное паросочетание. Когда мы удалим $K_k$ обратно, мы получим, что в $G+K_k$ есть паросочетание на $n-2k$ вершин. Это даёт нам оценку на равенство, а пример следует напрямую из теоремы Татта.
    \end{proof} 
    \begin{definition}
        \textbf{Дефицитом графа} называется величина справа в теореме Бержа.
    \end{definition}
\end{document}
